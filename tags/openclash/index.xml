<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>OpenClash on 晴耕雨讀</title><link>http://0x3f.org/tags/openclash/</link><description>Recent content in OpenClash on 晴耕雨讀</description><generator>Hugo</generator><language>zh-cn</language><copyright>© 2007-2024 鬼马妖刀</copyright><lastBuildDate>Thu, 12 Feb 2026 20:30:00 +0800</lastBuildDate><atom:link href="http://0x3f.org/tags/openclash/index.xml" rel="self" type="application/rss+xml"/><item><title>解决 Clash 导致小红书网页版图片无法显示的问题</title><link>http://0x3f.org/posts/fix-xiaohongshu-image-loading-issue-with-clash/</link><pubDate>Thu, 12 Feb 2026 20:30:00 +0800</pubDate><guid>http://0x3f.org/posts/fix-xiaohongshu-image-loading-issue-with-clash/</guid><description>&lt;p&gt;家里通过运行了 OpenClash 的旁路网关上网，手机和电脑上则用 Stash ，两者都是 Clash 的客户端。最近发现一个恼人的问题：每隔一段时间，小红书网页版的图片就集体罢工，只剩一片空白。&lt;/p&gt;
&lt;p&gt;&lt;img src="https://raw.githubusercontent.com/xbot/image-hosting/master/blog/20260212200814939-ee7996ac33de8c8202341d2a6e265153.avif" alt="小红书图片加载失败"&gt;&lt;/p&gt;
&lt;p&gt;打开浏览器开发者工具一看，图片请求全报了同一个错误：&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;net::ERR_SSL_VERSION_OR_CIPHER_MISMATCH
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;这个错误的意思是 TLS 握手失败了。原因在于 Clash 的 Fake IP 模式。开启 Fake IP 后，Clash 会对 DNS 请求返回一个虚假的 IP 地址（通常是 198.18.x.x 段），浏览器拿着这个假 IP 发起 HTTPS 连接，由 Clash 拦截后再转发到真实服务器。问题出在小红书 CDN（xhscdn.com）的 TLS 配置比较严格，Clash 中转连接时 TLS 握手参数无法正确协商，于是就报了这个 SSL 错误，图片自然加载不出来。&lt;/p&gt;
&lt;p&gt;解决办法很简单：让 Clash 对小红书 CDN 的域名不使用 Fake IP ，直接返回真实 IP 。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;OpenClash&lt;/strong&gt; 在配置文件 &lt;code&gt;/etc/openclash/custom/openclash_custom_fake_filter.list&lt;/code&gt; 中添加一行：&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;*.xhscdn.com
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Stash&lt;/strong&gt; 的配置路径是：Settings → Config File → Visualization Editor → DNS → Fake IP Filter ，把 &lt;code&gt;*.xhscdn.com&lt;/code&gt; 加进去即可。&lt;/p&gt;</description></item><item><title>让 AdGuard Home 和 OpenClash 协同工作</title><link>http://0x3f.org/posts/make-adguard-home-and-openclash-work-together/</link><pubDate>Sun, 06 Mar 2022 12:12:10 +0800</pubDate><guid>http://0x3f.org/posts/make-adguard-home-and-openclash-work-together/</guid><description>&lt;h1 id="家庭网络环境"&gt;家庭网络环境&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;使用 OpenWrt （&lt;em&gt;以下简称 OP&lt;/em&gt; ）做旁路网关&lt;/li&gt;
&lt;li&gt;OP 内建 OpenClash （&lt;em&gt;以下简称 OC&lt;/em&gt; ）访问不存在的网站&lt;/li&gt;
&lt;li&gt;OP 内建 WireGuard （&lt;em&gt;以下简称 WG&lt;/em&gt; ）做内网穿透&lt;/li&gt;
&lt;li&gt;使用 AdGuard Home （&lt;em&gt;以下简称 AH&lt;/em&gt; ）做内网 DNS 和广告过滤&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id="之前遇到的问题"&gt;之前遇到的问题&lt;/h1&gt;
&lt;p&gt;不管怎样配置，内网和 WG 下的内网主机名解析和科学上网这 4 种场景总有至少一个不工作。&lt;/p&gt;
&lt;p&gt;期间创建过一个虚拟机做独立的 WG Server ，内建 SmartDNS （&lt;em&gt;以下简称 SD&lt;/em&gt; ）做 AH 的上游，其它场景工作得很好，只是无法通过旁路网关访问不存在的网站。&lt;/p&gt;
&lt;h1 id="解决方法"&gt;解决方法&lt;/h1&gt;
&lt;p&gt;首先如果要正常使用 OC ，就必须使用它的 DNS 解析。&lt;/p&gt;
&lt;p&gt;同时，又要达到使用 AH 做内网主机名解析和广告过滤的目的，所以要把 OC 设成 AH 的唯一上游。&lt;/p&gt;
&lt;p&gt;然后最棘手的问题来了。如果把 AH 设成 dnsmasq 的上游， WG 下不能解析内网主机名。如果把 AH 设成监听 53 端口，则内网无法解析主机名。&lt;/p&gt;
&lt;p&gt;想到之前在独立的 WG Server 上用 SD 在两种场景下都可以正常解析，就试着用它代替 dnsmasq ，结果柳暗花明，所以场景都跑通了。&lt;/p&gt;</description></item></channel></rss>