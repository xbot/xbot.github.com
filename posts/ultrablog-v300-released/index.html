<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta property="og:title" content="UltraBlog.vim v3.0é‡Šå‡ºï¼šå…¨æ–‡æ£€ç´¢ä¸äº‹ä»¶é©±åŠ¨"><meta property="og:description" content="ç”¨äº†ä¸€å‘¨çš„ä¸šä½™æ—¶é—´ï¼Œæ˜¨å¤©æˆ‘é‡Šå‡ºäº†UltraBlog.vimçš„3.0ç‰ˆã€‚æ–°ç‰ˆæœ¬ä¸»è¦åŠ å…¥äº†å…¨æ–‡æ£€ç´¢çš„åŠŸèƒ½ï¼Œå¹¶å¼•å…¥äº‹ä»¶é©±åŠ¨çš„æ¨¡å¼ã€‚
å…¨æ–‡æ£€ç´¢æ˜¯æˆ‘è“„è°‹å·²ä¹…çš„åŠŸèƒ½ï¼Œä¸€ä¸ªä¸èƒ½æœç´¢çš„åšå®¢å®¢æˆ·ç«¯çš„ç®¡ç†åŠŸèƒ½æ˜¯å¤§æ‰“æŠ˜æ‰£çš„ã€‚å¾—ç›ŠäºSQLiteæ•°æ®åº“å’ŒSQLAlchemyæ¡†æ¶ï¼Œå…¨æ–‡æ£€ç´¢çš„å®ç°æ˜¯å¾ˆç®€å•çš„ï¼Œæ–°å¢åŠ çš„:UBFindå‘½ä»¤å°†åœ¨æ‰€æœ‰æ–‡ç« å’Œé¡µé¢çš„æ ‡é¢˜ä¸å†…å®¹ä¸­æŸ¥è¯¢ï¼Œå¹¶å°†æœç´¢ç»“æœæ˜¾ç¤ºåœ¨ä¸€ä¸ªå¯åˆ†é¡µçš„åˆ—è¡¨ä¸­ã€‚è¿™ä¸ªå‘½ä»¤æ”¯æŒä»»æ„å¤šä¸ªå…³é”®è¯ï¼Œå„å…³é”®è¯ä¹‹é—´éµå¾ªä¸çš„å…³ç³»ã€‚æ­¤å¤–ï¼Œæ£€ç´¢ç»“æœä¸­ï¼Œæ‰€æœ‰çš„å…³é”®è¯å°†è¢«è‡ªåŠ¨æ ‡è®°ä¸ºé«˜äº®ã€‚
äº‹ä»¶é©±åŠ¨æ¨¡å¼çš„å¼•å…¥æ˜¯æˆ‘æ‚ç„¶å°†ç‰ˆæœ¬å·è·³è·ƒåˆ°3.xçš„ä¸»è¦åŸå› ã€‚
åœ¨å‰å‡ ä¸ªç‰ˆæœ¬ä¸­ï¼Œæˆ‘å®ç°äº†å¯¹å¤šçª—å£çš„æ”¯æŒï¼Œå®ƒä½¿å¾—ç”¨æˆ·å¯ä»¥åœ¨æ–°çª—å£ä¸­æ‰“å¼€åˆ—è¡¨ä¸­çš„æ–‡ç« ã€‚ä½†UltraBlog.vimæœ€åˆå¼€å‘çš„æ—¶å€™å¹¶æ²¡æœ‰è€ƒè™‘åˆ°å¤šçª—å£çš„é—®é¢˜ï¼Œæ‰€æœ‰å‘½ä»¤éƒ½åªé’ˆå¯¹å½“å‰çª—å£è¿›è¡Œæ“ä½œã€‚è¿™å°±æœ‰äº†ç¼“å†²åŒºå†…å®¹åŒæ­¥çš„é—®é¢˜ï¼Œå‡å¦‚åœ¨ä¸€ä¸ªæ–°çš„ç¼“å†²åŒºä¸­æ‰“å¼€äº†å’Œå¦ä¸€ä¸ªç¼“å†²åŒºç›¸åŒçš„æ–‡ç« ï¼Œåˆ™ä¸€ä¸ªç¼“å†²åŒºå†…å®¹çš„æ”¹å˜ä¸ä¼šåŒæ­¥åˆ°å¦å¤–ä¸€ä¸ªä¸­ï¼Œè¿™å¤šå°‘æ˜¯æœ‰äº›éšæ‚£çš„ã€‚
æœ€ç›´æ¥çš„åšæ³•æ˜¯åœ¨æ‰€æœ‰å¯èƒ½æ”¹å˜ç¼“å†²åŒºå†…å®¹çš„åŠŸèƒ½ä¸­åŠ å…¥å¯¹å…¶å®ƒç¼“å†²åŒºçš„å¤„ç†ï¼Œä½†è¿™æ ·åšæœ‰ä¸å°‘é—®é¢˜ï¼š
ä»£ç è€¦åˆåº¦å¤ªé«˜ï¼Œè¿åK.I.S.SåŸåˆ™ï¼Œä¸åˆ©äºä»Šåçš„å¼€å‘å’Œç»´æŠ¤ å‡½æ•°ä½“è¿‡é•¿ï¼Œæˆ‘è®¨åŒéš¾çœ‹çš„ä»£ç  ä»£ç å†—ä½™ï¼Œé‡å¤åŠ³åŠ¨ äº‹ä»¶é©±åŠ¨æ¨¡å¼å¯ä»¥å¾ˆå¥½çš„è§£å†³ä»¥ä¸Šé—®é¢˜ï¼Œä¸€ä¸ªå‡½æ•°åªå¹²ä¸€ä»¶äº‹ï¼Œåšå®Œåä¸€ä¸ªäº‹ä»¶æŠ›å‡ºå»ï¼Œè‡³äºè¿å¸¦è‘—è¦åšä»€ä¹ˆï¼Œè°ç›‘å¬è¿™ä¸ªäº‹ä»¶è°å»å¤„ç†ï¼Œä»£ç çš„è€¦åˆåº¦å¾ˆä½ï¼Œå¤ç”¨åº¦å¾ˆé«˜ï¼Œæ˜“äºç»´æŠ¤å’Œé˜…è¯»ã€‚
UltraBlog.vimå¼•å…¥äº‹ä»¶é©±åŠ¨æ¨¡å¼å¤„ç†ç¼“å†²åŒºåŒæ­¥çš„é—®é¢˜ã€‚ä¸åŒçš„æ“ä½œæŠ›å‡ºä¸åŒçš„äº‹ä»¶ï¼Œæ‰€æœ‰çš„äº‹ä»¶ç»§æ‰¿è‡ªçˆ¶ç±»UBEventï¼š
```python class UBEvent: def __init__(self, srcObj): self.srcObj = srcObj class UBDebugEvent(UBEvent): pass class UBTmplDelEvent(UBEvent): pass class UBTmplSaveEvent(UBEvent): pass class UBLocalPostDelEvent(UBEvent): pass class UBRemotePostDelEvent(UBEvent): pass class UBPostSendEvent(UBEvent): pass class UBPostSaveEvent(UBEvent): pass ``` ä¸€ä¸ªå¯èƒ½æ”¹å˜ç¼“å†²åŒºå†…å®¹çš„æ“ä½œæ‰§è¡Œå®Œåï¼Œåˆ›å»ºä¸€ä¸ªç‰¹å®šçš„äº‹ä»¶å¹¶å°†å…¶åŠ å…¥åˆ°äº‹ä»¶é˜Ÿåˆ—ä¸­ã€‚äº‹ä»¶é˜Ÿåˆ—ç±»ä¸­å­˜æ”¾ä¸¤ä¸ªåˆ—è¡¨ï¼Œä¸€æ˜¯äº‹ä»¶é˜Ÿåˆ—ï¼ŒäºŒæ˜¯äº‹ä»¶ç›‘å¬å™¨åˆ—è¡¨ï¼›æä¾›ä¸‰ä¸ªæ–¹æ³•ï¼Œåˆ†åˆ«ç”¨æ¥æ³¨å†Œäº‹ä»¶ç›‘å¬å™¨ã€å¯¹äº‹ä»¶æ‰§è¡Œå…¥é˜Ÿåˆ—æ“ä½œå’Œå¤„ç†é˜Ÿåˆ—ä¸­æ‰€æœ‰äº‹ä»¶ï¼š
```python class UBEventQueue: queue = [] listeners = [] @classmethod def fireEvent(cls, evt): cls.queue.append(evt) @classmethod def processEvents(cls): for evt in cls.queue: for listener in cls.listeners: if listener.isTarget(evt): cls.queue.remove(evt) listener."><meta property="og:type" content="article"><meta property="og:url" content="http://0x3f.org/posts/ultrablog-v300-released/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2011-07-25T00:00:00+00:00"><meta property="article:modified_time" content="2011-07-25T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="UltraBlog.vim v3.0é‡Šå‡ºï¼šå…¨æ–‡æ£€ç´¢ä¸äº‹ä»¶é©±åŠ¨"><meta name=twitter:description content="ç”¨äº†ä¸€å‘¨çš„ä¸šä½™æ—¶é—´ï¼Œæ˜¨å¤©æˆ‘é‡Šå‡ºäº†UltraBlog.vimçš„3.0ç‰ˆã€‚æ–°ç‰ˆæœ¬ä¸»è¦åŠ å…¥äº†å…¨æ–‡æ£€ç´¢çš„åŠŸèƒ½ï¼Œå¹¶å¼•å…¥äº‹ä»¶é©±åŠ¨çš„æ¨¡å¼ã€‚
å…¨æ–‡æ£€ç´¢æ˜¯æˆ‘è“„è°‹å·²ä¹…çš„åŠŸèƒ½ï¼Œä¸€ä¸ªä¸èƒ½æœç´¢çš„åšå®¢å®¢æˆ·ç«¯çš„ç®¡ç†åŠŸèƒ½æ˜¯å¤§æ‰“æŠ˜æ‰£çš„ã€‚å¾—ç›ŠäºSQLiteæ•°æ®åº“å’ŒSQLAlchemyæ¡†æ¶ï¼Œå…¨æ–‡æ£€ç´¢çš„å®ç°æ˜¯å¾ˆç®€å•çš„ï¼Œæ–°å¢åŠ çš„:UBFindå‘½ä»¤å°†åœ¨æ‰€æœ‰æ–‡ç« å’Œé¡µé¢çš„æ ‡é¢˜ä¸å†…å®¹ä¸­æŸ¥è¯¢ï¼Œå¹¶å°†æœç´¢ç»“æœæ˜¾ç¤ºåœ¨ä¸€ä¸ªå¯åˆ†é¡µçš„åˆ—è¡¨ä¸­ã€‚è¿™ä¸ªå‘½ä»¤æ”¯æŒä»»æ„å¤šä¸ªå…³é”®è¯ï¼Œå„å…³é”®è¯ä¹‹é—´éµå¾ªä¸çš„å…³ç³»ã€‚æ­¤å¤–ï¼Œæ£€ç´¢ç»“æœä¸­ï¼Œæ‰€æœ‰çš„å…³é”®è¯å°†è¢«è‡ªåŠ¨æ ‡è®°ä¸ºé«˜äº®ã€‚
äº‹ä»¶é©±åŠ¨æ¨¡å¼çš„å¼•å…¥æ˜¯æˆ‘æ‚ç„¶å°†ç‰ˆæœ¬å·è·³è·ƒåˆ°3.xçš„ä¸»è¦åŸå› ã€‚
åœ¨å‰å‡ ä¸ªç‰ˆæœ¬ä¸­ï¼Œæˆ‘å®ç°äº†å¯¹å¤šçª—å£çš„æ”¯æŒï¼Œå®ƒä½¿å¾—ç”¨æˆ·å¯ä»¥åœ¨æ–°çª—å£ä¸­æ‰“å¼€åˆ—è¡¨ä¸­çš„æ–‡ç« ã€‚ä½†UltraBlog.vimæœ€åˆå¼€å‘çš„æ—¶å€™å¹¶æ²¡æœ‰è€ƒè™‘åˆ°å¤šçª—å£çš„é—®é¢˜ï¼Œæ‰€æœ‰å‘½ä»¤éƒ½åªé’ˆå¯¹å½“å‰çª—å£è¿›è¡Œæ“ä½œã€‚è¿™å°±æœ‰äº†ç¼“å†²åŒºå†…å®¹åŒæ­¥çš„é—®é¢˜ï¼Œå‡å¦‚åœ¨ä¸€ä¸ªæ–°çš„ç¼“å†²åŒºä¸­æ‰“å¼€äº†å’Œå¦ä¸€ä¸ªç¼“å†²åŒºç›¸åŒçš„æ–‡ç« ï¼Œåˆ™ä¸€ä¸ªç¼“å†²åŒºå†…å®¹çš„æ”¹å˜ä¸ä¼šåŒæ­¥åˆ°å¦å¤–ä¸€ä¸ªä¸­ï¼Œè¿™å¤šå°‘æ˜¯æœ‰äº›éšæ‚£çš„ã€‚
æœ€ç›´æ¥çš„åšæ³•æ˜¯åœ¨æ‰€æœ‰å¯èƒ½æ”¹å˜ç¼“å†²åŒºå†…å®¹çš„åŠŸèƒ½ä¸­åŠ å…¥å¯¹å…¶å®ƒç¼“å†²åŒºçš„å¤„ç†ï¼Œä½†è¿™æ ·åšæœ‰ä¸å°‘é—®é¢˜ï¼š
ä»£ç è€¦åˆåº¦å¤ªé«˜ï¼Œè¿åK.I.S.SåŸåˆ™ï¼Œä¸åˆ©äºä»Šåçš„å¼€å‘å’Œç»´æŠ¤ å‡½æ•°ä½“è¿‡é•¿ï¼Œæˆ‘è®¨åŒéš¾çœ‹çš„ä»£ç  ä»£ç å†—ä½™ï¼Œé‡å¤åŠ³åŠ¨ äº‹ä»¶é©±åŠ¨æ¨¡å¼å¯ä»¥å¾ˆå¥½çš„è§£å†³ä»¥ä¸Šé—®é¢˜ï¼Œä¸€ä¸ªå‡½æ•°åªå¹²ä¸€ä»¶äº‹ï¼Œåšå®Œåä¸€ä¸ªäº‹ä»¶æŠ›å‡ºå»ï¼Œè‡³äºè¿å¸¦è‘—è¦åšä»€ä¹ˆï¼Œè°ç›‘å¬è¿™ä¸ªäº‹ä»¶è°å»å¤„ç†ï¼Œä»£ç çš„è€¦åˆåº¦å¾ˆä½ï¼Œå¤ç”¨åº¦å¾ˆé«˜ï¼Œæ˜“äºç»´æŠ¤å’Œé˜…è¯»ã€‚
UltraBlog.vimå¼•å…¥äº‹ä»¶é©±åŠ¨æ¨¡å¼å¤„ç†ç¼“å†²åŒºåŒæ­¥çš„é—®é¢˜ã€‚ä¸åŒçš„æ“ä½œæŠ›å‡ºä¸åŒçš„äº‹ä»¶ï¼Œæ‰€æœ‰çš„äº‹ä»¶ç»§æ‰¿è‡ªçˆ¶ç±»UBEventï¼š
```python class UBEvent: def __init__(self, srcObj): self.srcObj = srcObj class UBDebugEvent(UBEvent): pass class UBTmplDelEvent(UBEvent): pass class UBTmplSaveEvent(UBEvent): pass class UBLocalPostDelEvent(UBEvent): pass class UBRemotePostDelEvent(UBEvent): pass class UBPostSendEvent(UBEvent): pass class UBPostSaveEvent(UBEvent): pass ``` ä¸€ä¸ªå¯èƒ½æ”¹å˜ç¼“å†²åŒºå†…å®¹çš„æ“ä½œæ‰§è¡Œå®Œåï¼Œåˆ›å»ºä¸€ä¸ªç‰¹å®šçš„äº‹ä»¶å¹¶å°†å…¶åŠ å…¥åˆ°äº‹ä»¶é˜Ÿåˆ—ä¸­ã€‚äº‹ä»¶é˜Ÿåˆ—ç±»ä¸­å­˜æ”¾ä¸¤ä¸ªåˆ—è¡¨ï¼Œä¸€æ˜¯äº‹ä»¶é˜Ÿåˆ—ï¼ŒäºŒæ˜¯äº‹ä»¶ç›‘å¬å™¨åˆ—è¡¨ï¼›æä¾›ä¸‰ä¸ªæ–¹æ³•ï¼Œåˆ†åˆ«ç”¨æ¥æ³¨å†Œäº‹ä»¶ç›‘å¬å™¨ã€å¯¹äº‹ä»¶æ‰§è¡Œå…¥é˜Ÿåˆ—æ“ä½œå’Œå¤„ç†é˜Ÿåˆ—ä¸­æ‰€æœ‰äº‹ä»¶ï¼š
```python class UBEventQueue: queue = [] listeners = [] @classmethod def fireEvent(cls, evt): cls.queue.append(evt) @classmethod def processEvents(cls): for evt in cls.queue: for listener in cls.listeners: if listener.isTarget(evt): cls.queue.remove(evt) listener."><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-93233020-1","auto"),ga("send","pageview"))</script><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#262d33"><title>æ™´è€•é›¨è®€ - UltraBlog.vim v3.0é‡Šå‡ºï¼šå…¨æ–‡æ£€ç´¢ä¸äº‹ä»¶é©±åŠ¨</title><link rel="shortcut icon" href=/favicon.ico type=image/x-icon><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;500;600;700&display=swap" rel=stylesheet><link rel=stylesheet href=/minima.1666520191.css><script defer type=text/javascript src=/minima.1666520191.js></script></head><script>let theme_2b_used=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";try{if(!("theme"in localStorage)){const e="";(e==="dark"||e==="light")&&(theme_2b_used=e),localStorage.theme=theme_2b_used}document.querySelector("html").classList.add(localStorage.theme)}catch(e){console.error(e)}</script><body class="sm:mx-5 sm:my-0"><header class="flex justify-between items-center mb-6 sm:my-3"><div class="flex items-center"><div id=theme-switcher class="text-4xl cursor-pointer">ğŸŒš</div></div><nav class="flex items-center
whitespace-nowrap overflow-x-auto overflow-y-hidden"><a class=ml-5 href=/>ä¸»é </a>
<a class=ml-5 href=/posts>æ–‡ç« </a>
<a class=ml-5 href=/tags>æ¨™ç±¤</a>
<a class=ml-5 href=/categories>åˆ†é¡</a>
<a class=ml-5 href=/about>é—œæ–¼</a></nav></header><h1 class="mt-6 mb-6">UltraBlog.vim v3.0é‡Šå‡ºï¼šå…¨æ–‡æ£€ç´¢ä¸äº‹ä»¶é©±åŠ¨</h1><div class="mb-3 text-xs flex justify-between sm:flex-col"><div>Posted at &mdash; Jul 25, 2011</div><div class=sm:mt-4><a class=not-first:ml-3 href=/tags/Plugin>#Plugin</a>
<a class=not-first:ml-3 href=/tags/Python>#Python</a>
<a class=not-first:ml-3 href=/tags/UltraBlog.vim>#UltraBlog.vim</a>
<a class=not-first:ml-3 href=/tags/Vim>#Vim</a>
<a class=not-first:ml-3 href=/tags/%e5%8d%9a%e5%ae%a2>#åšå®¢</a>
<a class=not-first:ml-3 href=/tags/%e7%bc%96%e7%a8%8b>#ç¼–ç¨‹</a></div></div><main><p></p><article class=md><p>ç”¨äº†ä¸€å‘¨çš„ä¸šä½™æ—¶é—´ï¼Œæ˜¨å¤©æˆ‘é‡Šå‡ºäº†<a href=http://0x3f.org/posts/ultrablog-as-an-ultimate-vim-blogging-plugin/>UltraBlog.vim</a>çš„3.0ç‰ˆã€‚æ–°ç‰ˆæœ¬ä¸»è¦åŠ å…¥äº†å…¨æ–‡æ£€ç´¢çš„åŠŸèƒ½ï¼Œå¹¶å¼•å…¥äº‹ä»¶é©±åŠ¨çš„æ¨¡å¼ã€‚</p><p>å…¨æ–‡æ£€ç´¢æ˜¯æˆ‘è“„è°‹å·²ä¹…çš„åŠŸèƒ½ï¼Œä¸€ä¸ªä¸èƒ½æœç´¢çš„åšå®¢å®¢æˆ·ç«¯çš„ç®¡ç†åŠŸèƒ½æ˜¯å¤§æ‰“æŠ˜æ‰£çš„ã€‚å¾—ç›ŠäºSQLiteæ•°æ®åº“å’ŒSQLAlchemyæ¡†æ¶ï¼Œå…¨æ–‡æ£€ç´¢çš„å®ç°æ˜¯å¾ˆç®€å•çš„ï¼Œæ–°å¢åŠ çš„<code>:UBFind</code>å‘½ä»¤å°†åœ¨æ‰€æœ‰æ–‡ç« å’Œé¡µé¢çš„æ ‡é¢˜ä¸å†…å®¹ä¸­æŸ¥è¯¢ï¼Œå¹¶å°†æœç´¢ç»“æœæ˜¾ç¤ºåœ¨ä¸€ä¸ªå¯åˆ†é¡µçš„åˆ—è¡¨ä¸­ã€‚è¿™ä¸ªå‘½ä»¤æ”¯æŒä»»æ„å¤šä¸ªå…³é”®è¯ï¼Œå„å…³é”®è¯ä¹‹é—´éµå¾ªä¸çš„å…³ç³»ã€‚æ­¤å¤–ï¼Œæ£€ç´¢ç»“æœä¸­ï¼Œæ‰€æœ‰çš„å…³é”®è¯å°†è¢«è‡ªåŠ¨æ ‡è®°ä¸ºé«˜äº®ã€‚</p><p>äº‹ä»¶é©±åŠ¨æ¨¡å¼çš„å¼•å…¥æ˜¯æˆ‘æ‚ç„¶å°†ç‰ˆæœ¬å·è·³è·ƒåˆ°3.xçš„ä¸»è¦åŸå› ã€‚</p><p>åœ¨å‰å‡ ä¸ªç‰ˆæœ¬ä¸­ï¼Œæˆ‘å®ç°äº†å¯¹å¤šçª—å£çš„æ”¯æŒï¼Œå®ƒä½¿å¾—ç”¨æˆ·å¯ä»¥åœ¨æ–°çª—å£ä¸­æ‰“å¼€åˆ—è¡¨ä¸­çš„æ–‡ç« ã€‚ä½†UltraBlog.vimæœ€åˆå¼€å‘çš„æ—¶å€™å¹¶æ²¡æœ‰è€ƒè™‘åˆ°å¤šçª—å£çš„é—®é¢˜ï¼Œæ‰€æœ‰å‘½ä»¤éƒ½åªé’ˆå¯¹å½“å‰çª—å£è¿›è¡Œæ“ä½œã€‚è¿™å°±æœ‰äº†ç¼“å†²åŒºå†…å®¹åŒæ­¥çš„é—®é¢˜ï¼Œå‡å¦‚åœ¨ä¸€ä¸ªæ–°çš„ç¼“å†²åŒºä¸­æ‰“å¼€äº†å’Œå¦ä¸€ä¸ªç¼“å†²åŒºç›¸åŒçš„æ–‡ç« ï¼Œåˆ™ä¸€ä¸ªç¼“å†²åŒºå†…å®¹çš„æ”¹å˜ä¸ä¼šåŒæ­¥åˆ°å¦å¤–ä¸€ä¸ªä¸­ï¼Œè¿™å¤šå°‘æ˜¯æœ‰äº›éšæ‚£çš„ã€‚</p><p>æœ€ç›´æ¥çš„åšæ³•æ˜¯åœ¨æ‰€æœ‰å¯èƒ½æ”¹å˜ç¼“å†²åŒºå†…å®¹çš„åŠŸèƒ½ä¸­åŠ å…¥å¯¹å…¶å®ƒç¼“å†²åŒºçš„å¤„ç†ï¼Œä½†è¿™æ ·åšæœ‰ä¸å°‘é—®é¢˜ï¼š</p><ul><li>ä»£ç è€¦åˆåº¦å¤ªé«˜ï¼Œè¿åK.I.S.SåŸåˆ™ï¼Œä¸åˆ©äºä»Šåçš„å¼€å‘å’Œç»´æŠ¤</li><li>å‡½æ•°ä½“è¿‡é•¿ï¼Œæˆ‘è®¨åŒéš¾çœ‹çš„ä»£ç </li><li>ä»£ç å†—ä½™ï¼Œé‡å¤åŠ³åŠ¨</li></ul><p>äº‹ä»¶é©±åŠ¨æ¨¡å¼å¯ä»¥å¾ˆå¥½çš„è§£å†³ä»¥ä¸Šé—®é¢˜ï¼Œä¸€ä¸ªå‡½æ•°åªå¹²ä¸€ä»¶äº‹ï¼Œåšå®Œåä¸€ä¸ªäº‹ä»¶æŠ›å‡ºå»ï¼Œè‡³äºè¿å¸¦è‘—è¦åšä»€ä¹ˆï¼Œè°ç›‘å¬è¿™ä¸ªäº‹ä»¶è°å»å¤„ç†ï¼Œä»£ç çš„è€¦åˆåº¦å¾ˆä½ï¼Œå¤ç”¨åº¦å¾ˆé«˜ï¼Œæ˜“äºç»´æŠ¤å’Œé˜…è¯»ã€‚</p><p>UltraBlog.vimå¼•å…¥äº‹ä»¶é©±åŠ¨æ¨¡å¼å¤„ç†ç¼“å†²åŒºåŒæ­¥çš„é—®é¢˜ã€‚ä¸åŒçš„æ“ä½œæŠ›å‡ºä¸åŒçš„äº‹ä»¶ï¼Œæ‰€æœ‰çš„äº‹ä»¶ç»§æ‰¿è‡ªçˆ¶ç±»<strong>UBEvent</strong>ï¼š</p>```python
class UBEvent:
def __init__(self, srcObj):
self.srcObj = srcObj
class UBDebugEvent(UBEvent): pass
class UBTmplDelEvent(UBEvent): pass
class UBTmplSaveEvent(UBEvent): pass
class UBLocalPostDelEvent(UBEvent): pass
class UBRemotePostDelEvent(UBEvent): pass
class UBPostSendEvent(UBEvent): pass
class UBPostSaveEvent(UBEvent): pass
```<p>ä¸€ä¸ªå¯èƒ½æ”¹å˜ç¼“å†²åŒºå†…å®¹çš„æ“ä½œæ‰§è¡Œå®Œåï¼Œåˆ›å»ºä¸€ä¸ªç‰¹å®šçš„äº‹ä»¶å¹¶å°†å…¶åŠ å…¥åˆ°äº‹ä»¶é˜Ÿåˆ—ä¸­ã€‚äº‹ä»¶é˜Ÿåˆ—ç±»ä¸­å­˜æ”¾ä¸¤ä¸ªåˆ—è¡¨ï¼Œä¸€æ˜¯äº‹ä»¶é˜Ÿåˆ—ï¼ŒäºŒæ˜¯äº‹ä»¶ç›‘å¬å™¨åˆ—è¡¨ï¼›æä¾›ä¸‰ä¸ªæ–¹æ³•ï¼Œåˆ†åˆ«ç”¨æ¥æ³¨å†Œäº‹ä»¶ç›‘å¬å™¨ã€å¯¹äº‹ä»¶æ‰§è¡Œå…¥é˜Ÿåˆ—æ“ä½œå’Œå¤„ç†é˜Ÿåˆ—ä¸­æ‰€æœ‰äº‹ä»¶ï¼š</p>```python
class UBEventQueue:
queue = []
listeners = []
@classmethod
def fireEvent(cls, evt):
cls.queue.append(evt)
@classmethod
def processEvents(cls):
for evt in cls.queue:
for listener in cls.listeners:
if listener.isTarget(evt):
cls.queue.remove(evt)
listener.processEvent(evt)
@classmethod
def registerListener(cls, lsnr):
cls.listeners.append(lsnr)
```<p>äº‹ä»¶é˜Ÿåˆ—å¯¹äº‹ä»¶çš„å¤„ç†æ˜¯é€šè¿‡äº‹ä»¶ç›‘å¬å™¨è¿›è¡Œçš„ï¼Œæ¯ä¸ªäº‹ä»¶ç›‘å¬å™¨è¦å®ç°ä¸¤ä¸ªåŠŸèƒ½ï¼šè¯†åˆ«ç›‘å¬å¯¹è±¡å’Œå¤„ç†ç›‘å¬å¯¹è±¡ã€‚æ‰€æœ‰å…·ä½“äº‹ä»¶çš„ç›‘å¬ç±»éƒ½æ˜¯<strong>UBListener</strong>çš„å­ç±»ï¼š</p>```python
class UBListener():
''' Parent class of all listeners
'''
eventType = None
@classmethod
def isTarget(cls, evt):
return isinstance(evt, cls.eventType)
@staticmethod
def processEvent(evt): pass
class UBPostSaveListener(UBListener):
''' Listener for saving posts/pages
1. Refresh the current view if it is an edit/list view of this post
2. Mark all edit/list views of posts/pages outdated
'''
eventType = UBPostSaveEvent
@staticmethod
def processEvent(evt):
for nr in ub_get_buffers(['post_edit','page_edit']):
if evt.srcObj==ub_get_meta('id', nr):
if nr==ub_get_bufnr('%'):
ub_refresh_current_view()
else:
ub_set_view_outdated(nr)
for nr in ub_get_buffers(['post_list','page_list','search_result_list']):
if nr == ub_get_bufnr('%'):
ub_refresh_current_view()
else:
ub_set_view_outdated(nr)
```<p>äº‹ä»¶ç›‘å¬å™¨éå†æ‰€æœ‰æ»¡è¶³å¤„ç†æ¡ä»¶çš„ç¼“å†²åŒºï¼Œå¯¹å½“å‰ç¼“å†²åŒºï¼Œç«‹å³åˆ·æ–°ï¼Œå…¶ä½™çš„æ ‡è®°ä¸ºå·²è¿‡æœŸã€‚åŒæ—¶åˆ©ç”¨Vimè‡ªèº«çš„äº‹ä»¶é©±åŠ¨ç‰¹æ€§ï¼Œåœ¨è¿›å…¥å·²è¿‡æœŸçš„ç¼“å†²åŒºæ—¶ï¼Œå†æ›´æ–°ä¹‹ï¼Œä¹Ÿå°±æ˜¯ä¼ è¯´ä¸­çš„æ‡’åŠ è½½æ¨¡å¼ï¼š</p>```vim
au BufEnter * py __ub_on_buffer_enter()
```
```python
@__ub_exception_handler
def __ub_on_buffer_enter():
''' Triggered by BufEnter event, check if the buffer is outdated
'''
if ub_is_view_outdated('%'):
ub_refresh_current_view()
ub_set_view_outdated('%', False)
```<p>æ­¤å¤–ï¼Œéšè‘—ä»£ç é‡çš„å¢åŠ ï¼ŒåŸæ¥æŠŠå…¨éƒ¨ä»£ç éƒ½æ”¾åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­çš„åšæ³•ä¸å†é€‚ç”¨ï¼Œå°¤å…¶æ˜¯ä»¥<a href=http://en.wikipedia.org/wiki/Here_document>Here Document</a>å½¢å¼å­˜æ”¾åœ¨vimè„šæœ¬æ–‡ä»¶ä¸­çš„Pythonä»£ç ä¸èƒ½è¢«ctagsè¯†åˆ«ï¼Œæ‰€ä»¥æŒ‰ç±»åˆ«åˆ†åˆ«å­˜æ”¾åˆ°<strong>$VIMRUNTIME/plugin/ultrablog/</strong>ä¸‹çš„å‡ ä¸ªPythonæºæ–‡ä»¶ä¸­ã€‚</p><p>Posted via <a href=http://0x3f.org/posts/ultrablog-as-an-ultimate-vim-blogging-plugin/>UltraBlog.vim</a>.</p></article></main><script>const repo="xbot/blog-comments",issueTerm="pathname",theme=localStorage.theme?`github-${localStorage.theme}`:"preferred-color-scheme",script=document.createElement("script");script.src="https://utteranc.es/client.js",script.async=!0,script.crossOrigin="anonymous",script.setAttribute("repo",repo),script.setAttribute("issue-term",issueTerm),script.setAttribute("theme",theme),script.setAttribute("label","comment"),document.querySelector("main").appendChild(script)</script><footer class="mt-8 flex sm:flex-col-reverse justify-between items-center"><p class="mt-0 text-sm">Â© æ·˜æ°” 2022 |
<a href=https://gohugo.io target=_blank rel="noopener noreferrer">Hugo</a> on
<a href=https://github.com/mivinci/hugo-theme-minima target=_blank rel="noopener noreferrer">Minima</a></p><p class="flex items-center mt-0"><a class="icon mx-2" href=https://github.com/xbot title=github><svg fill="#63636f" width="18" role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63.0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577.0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93.0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176.0.0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22.0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22.0 1.606-.015 2.896-.015 3.286.0.315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><a class="icon mx-2" href=/index.xml title=rss><svg fill="#63636f" t="1626591563876" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" p-id="1984" width="18" height="16"><path d="M128 768a128 128 0 100 256 128 128 0 000-256zM0 368v176c265.104.0 480 214.912 480 480h176c0-362.32-293.696-656-656-656zM0 0v176c468.336.0 848 379.664 848 848h176C1024 458.464 565.536.0.0.0z" p-id="1985"/></svg></a></p></footer></body></html>