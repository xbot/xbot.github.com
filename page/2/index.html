<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">
  
  <title>晴耕雨讀</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="晴耕雨讀">
<meta property="og:url" content="http://0x3f.org/page/2/index.html">
<meta property="og:site_name" content="晴耕雨讀">
<meta property="og:locale" content="zh-TW">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="晴耕雨讀">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link href="/webfonts/ptserif/main.css" rel="stylesheet" type="text/css">
  <link href="/webfonts/source-code-pro/main.css" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/css/style.css">
  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-93233020-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


</head>
</html>
<body>
  <div id="container">
    <!-- blair add baidu tongji start... @2017.10.03 -->
<!-- blair add baidu tongji end ! @2017.10.03 -->

<header id="header">
  <div id="header-outer" class="outer">
    <div id="header-inner" class="inner">
      <a id="main-nav-toggle" class="nav-icon" href="javascript:;"></a>
      <a id="logo" class="logo" href="/"></a>
      <nav id="main-nav">
        
          <a class="main-nav-link" href="/archives">目录</a>
        
          <a class="main-nav-link" href="/categories">分类</a>
        
          <a class="main-nav-link" href="/tags">标签</a>
        
          <a class="main-nav-link" href="https://t.me/s/blingings">不灵</a>
        
          <a class="main-nav-link" href="/about">关于</a>
        
      </nav>
      <nav id="sub-nav">
        <div id="search-form-wrap">
          <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://0x3f.org"></form>
        </div>
      </nav>
    </div>
  </div>
</header>

    <br>
    <section id="main" class="outer">
      <article id="post-performance-comparation-for-laravel-excel-and-spout" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <myh11 itemprop="name">
      <a class="article-title-index" href="/post/performance-comparation-for-laravel-excel-and-spout/"><strong>对比Laravel Excel和Spout的读写性能</strong></a>
      <small class="article-date-index">&nbsp; 2019-07-07</small>
      <!--<a>
      <div = post.date  </div>
      </a>-->
      <br>
      <br> <!-- blair add -->
    </myh11>
  


      </header>
    
    <div class="article-meta">
      <!--<a href="/post/performance-comparation-for-laravel-excel-and-spout/" class="article-date">
  <time datetime="2019-07-07T12:23:26.000Z" itemprop="datePublished">2019-07-07</time>
</a>-->
      <!--
  <div class="article-category-index">
    <a class="article-category-index-link" href="/categories/计算机/">计算机</a>
  </div>

-->
      <!--
      
        <div class="article-comment-link-wrap">
          <a href="http://0x3f.org/post/performance-comparation-for-laravel-excel-and-spout/#disqus_thread" class="article-comment-link">Comments</a>
        </div>
      
      -->
    </div>
	
    <div class="article-entry" itemprop="articleBody">
      
        <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">./artisan excel:write --driver=spout --amount=100000</span><br><span class="line">写入数据100000行。</span><br><span class="line">用时：156秒。</span><br><span class="line">最大使用内存：2750.5106964111 M。</span><br><span class="line"></span><br><span class="line">./artisan excel:write --driver=laravel-excel --amount=100000</span><br><span class="line">写入数据100000行。</span><br><span class="line">用时：305秒。</span><br><span class="line">最大使用内存：1330.7370758057 M。</span><br><span class="line"></span><br><span class="line">./artisan excel:read ./storage/app/test.xlsx --driver=spout</span><br><span class="line">读取数据100001行。</span><br><span class="line">用时：576秒。</span><br><span class="line">最大使用内存：122.15303039551 M。</span><br><span class="line"></span><br><span class="line">./artisan excel:read ./storage/app/test.xlsx --driver=laravel-excel</span><br><span class="line">读取数据100001行。</span><br><span class="line">用时：166秒。</span><br><span class="line">最大使用内存：739.48976898193 M。</span><br></pre></td></tr></table></figure>
<p>基本上，Laravel Excel写XLSX的性能是Spout的一半，但内存占用是对方的一半。而在读文件上，前者的性能是后者的约3倍多，而内存占用是后者的6倍。</p>
<p>测试环境：</p>
<ul>
<li>MBP 3.1 GHz Intel Core i5 8G内存</li>
<li>PHP 7.1.30</li>
<li>Laravel 5.8.27</li>
<li>Laravel Excel 3.1.14</li>
<li>Spout 3.0.1</li>
</ul>

      
    </div>
	
    <!--
	
    -->
    <!--
    
      <footer class="article-footer">
      </footer>
    
    -->
  </div>
  
</article>



    
      <article id="post-after-reading-chapter-14-of-clean-code" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <myh11 itemprop="name">
      <a class="article-title-index" href="/post/after-reading-chapter-14-of-clean-code/"><strong>《Clean Code》第十四章读后</strong></a>
      <small class="article-date-index">&nbsp; 2019-05-20</small>
      <!--<a>
      <div = post.date  </div>
      </a>-->
      <br>
      <br> <!-- blair add -->
    </myh11>
  


      </header>
    
    <div class="article-meta">
      <!--<a href="/post/after-reading-chapter-14-of-clean-code/" class="article-date">
  <time datetime="2019-05-20T15:48:41.000Z" itemprop="datePublished">2019-05-20</time>
</a>-->
      <!--
  <div class="article-category-index">
    <a class="article-category-index-link" href="/categories/青梅煮酒/">青梅煮酒</a>
  </div>

-->
      <!--
      
        <div class="article-comment-link-wrap">
          <a href="http://0x3f.org/post/after-reading-chapter-14-of-clean-code/#disqus_thread" class="article-comment-link">Comments</a>
        </div>
      
      -->
    </div>
	
    <div class="article-entry" itemprop="articleBody">
      
        <p>蹩脚的译文看着实在费解，干脆去看《Clean Code》的原版。第14章“Successive Refinement（逐步改进）”讲的是对一个用Java实现的解析命令行参数的类Args重构的过程。</p>
<p>很多人都应该好好看看这章。</p>
         
          <p class="article-more-link">
            <a href="/post/after-reading-chapter-14-of-clean-code/">继续看...</a>
          </p> 
        
      
    </div>
	
    <!--
	
    -->
    <!--
    
      <footer class="article-footer">
      </footer>
    
    -->
  </div>
  
</article>



    
      <article id="post-investigation-report-of-git-flows" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <myh11 itemprop="name">
      <a class="article-title-index" href="/post/investigation-report-of-git-flows/"><strong>Git工作流调研报告</strong></a>
      <small class="article-date-index">&nbsp; 2019-05-15</small>
      <!--<a>
      <div = post.date  </div>
      </a>-->
      <br>
      <br> <!-- blair add -->
    </myh11>
  


      </header>
    
    <div class="article-meta">
      <!--<a href="/post/investigation-report-of-git-flows/" class="article-date">
  <time datetime="2019-05-15T08:14:17.000Z" itemprop="datePublished">2019-05-15</time>
</a>-->
      <!--
  <div class="article-category-index">
    <a class="article-category-index-link" href="/categories/计算机/">计算机</a>
  </div>

-->
      <!--
      
        <div class="article-comment-link-wrap">
          <a href="http://0x3f.org/post/investigation-report-of-git-flows/#disqus_thread" class="article-comment-link">Comments</a>
        </div>
      
      -->
    </div>
	
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="面临的问题"><a href="#面临的问题" class="headerlink" title="面临的问题"></a>面临的问题</h2><ol>
<li><p>测试环境杂乱导致的问题</p>
<p>每个任务都要搭建测试环境，或者把闲置的测试环境切换到待测试分支。麻烦，而且容易出问题。</p>
</li>
<li><p>抢占beta环境的问题</p>
<p>每个任务部署到beta环境时都要和别人确认，同时其它任务都要等待。</p>
</li>
<li><p>上线任务A把尚在测试中的任务B的部分代码部署上线的问题</p>
<p>先把feature分支合并到master分支，再部署到beta环境。</p>
</li>
<li><p>任务A和B在逻辑上互斥或者代码有冲突，导致问题在上线后才发现</p>
<p>测试阶段是针对每个feature分支测试，而不是针对一个集成的分支。</p>
</li>
<li><p>不能保证所有上线的代码都经过测试</p>
<p>直接把feature分支合并到master分支，不能保证所有代码都经过测试。</p>
</li>
</ol>
         
          <p class="article-more-link">
            <a href="/post/investigation-report-of-git-flows/">继续看...</a>
          </p> 
        
      
    </div>
	
    <!--
	
    -->
    <!--
    
      <footer class="article-footer">
      </footer>
    
    -->
  </div>
  
</article>



    
      <article id="post-unit-testing-standard-for-laravel-based-projects" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <myh11 itemprop="name">
      <a class="article-title-index" href="/post/unit-testing-standard-for-laravel-based-projects/"><strong>基于Laravel的项目的单元测试规范</strong></a>
      <small class="article-date-index">&nbsp; 2019-03-24</small>
      <!--<a>
      <div = post.date  </div>
      </a>-->
      <br>
      <br> <!-- blair add -->
    </myh11>
  


      </header>
    
    <div class="article-meta">
      <!--<a href="/post/unit-testing-standard-for-laravel-based-projects/" class="article-date">
  <time datetime="2019-03-24T14:42:08.000Z" itemprop="datePublished">2019-03-24</time>
</a>-->
      <!--
  <div class="article-category-index">
    <a class="article-category-index-link" href="/categories/计算机/">计算机</a>
  </div>

-->
      <!--
      
        <div class="article-comment-link-wrap">
          <a href="http://0x3f.org/post/unit-testing-standard-for-laravel-based-projects/#disqus_thread" class="article-comment-link">Comments</a>
        </div>
      
      -->
    </div>
	
    <div class="article-entry" itemprop="articleBody">
      
        <p>单元测试是个好东西，解决了我很多问题，不论开发效率还是代码质量，都给我助益良多。最近想在团队内部推广，就拟了个规范草稿：</p>
         
          <p class="article-more-link">
            <a href="/post/unit-testing-standard-for-laravel-based-projects/">继续看...</a>
          </p> 
        
      
    </div>
	
    <!--
	
    -->
    <!--
    
      <footer class="article-footer">
      </footer>
    
    -->
  </div>
  
</article>



    
      <article id="post-replace-syntastic-with-ale" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <myh11 itemprop="name">
      <a class="article-title-index" href="/post/replace-syntastic-with-ale/"><strong>用ALE替换了Syntastic</strong></a>
      <small class="article-date-index">&nbsp; 2018-12-12</small>
      <!--<a>
      <div = post.date  </div>
      </a>-->
      <br>
      <br> <!-- blair add -->
    </myh11>
  


      </header>
    
    <div class="article-meta">
      <!--<a href="/post/replace-syntastic-with-ale/" class="article-date">
  <time datetime="2018-12-12T12:42:10.000Z" itemprop="datePublished">2018-12-12</time>
</a>-->
      <!--
  <div class="article-category-index">
    <a class="article-category-index-link" href="/categories/计算机/">计算机</a>
  </div>

-->
      <!--
      
        <div class="article-comment-link-wrap">
          <a href="http://0x3f.org/post/replace-syntastic-with-ale/#disqus_thread" class="article-comment-link">Comments</a>
        </div>
      
      -->
    </div>
	
    <div class="article-entry" itemprop="articleBody">
      
        <p>习惯频繁地保存源码，但是每次保存都有明显的卡顿，于是用Vim自己的调优功能跟踪了一下。</p>
         
          <p class="article-more-link">
            <a href="/post/replace-syntastic-with-ale/">继续看...</a>
          </p> 
        
      
    </div>
	
    <!--
	
    -->
    <!--
    
      <footer class="article-footer">
      </footer>
    
    -->
  </div>
  
</article>



    
      <article id="post-input-punctuations-with-rime" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <myh11 itemprop="name">
      <a class="article-title-index" href="/post/input-punctuations-with-rime/"><strong>配置鼠须管的特殊符号输入</strong></a>
      <small class="article-date-index">&nbsp; 2018-10-13</small>
      <!--<a>
      <div = post.date  </div>
      </a>-->
      <br>
      <br> <!-- blair add -->
    </myh11>
  


      </header>
    
    <div class="article-meta">
      <!--<a href="/post/input-punctuations-with-rime/" class="article-date">
  <time datetime="2018-10-13T03:59:50.000Z" itemprop="datePublished">2018-10-13</time>
</a>-->
      <!--
  <div class="article-category-index">
    <a class="article-category-index-link" href="/categories/计算机/">计算机</a>
  </div>

-->
      <!--
      
        <div class="article-comment-link-wrap">
          <a href="http://0x3f.org/post/input-punctuations-with-rime/#disqus_thread" class="article-comment-link">Comments</a>
        </div>
      
      -->
    </div>
	
    <div class="article-entry" itemprop="articleBody">
      
        <p><em>开源工具最常见的问题就是文档不全，实现一个需求的时候只能苦苦Google，甚至连蒙带猜。这也是我逐渐倾向买用户体验更好的收费软件的原因。</em></p>
<p>鼠须管是自带特殊符号码表的，在用户配置目录中的<code>symbols.yaml</code>，但是有的码表需要手动配置。经过查资料和摸索，关键在于以下几项配置：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">punctuator:</span></span><br><span class="line"><span class="attr">  import_preset:</span> <span class="string">symbols</span></span><br><span class="line"></span><br><span class="line"><span class="attr">recognizer:</span></span><br><span class="line"><span class="attr">  import_preset:</span> <span class="string">default</span></span><br><span class="line"><span class="attr">  patterns:</span></span><br><span class="line"><span class="attr">    punct:</span> <span class="string">"^/([a-z]+|[0-9]0?)$"</span></span><br></pre></td></tr></table></figure>
<p>然后就可以通过<code>【/】+【编码】</code>的方式显示符号备选项了，具体的编码可以到<code>symbols.yaml</code>里看，当然一般为了方便定制该码表，会复制并重命名该文件，然后上述的配置项里也要做相应的修改。</p>

      
    </div>
	
    <!--
	
    -->
    <!--
    
      <footer class="article-footer">
      </footer>
    
    -->
  </div>
  
</article>



    
      <article id="post-i-am-wang-zhandou" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <myh11 itemprop="name">
      <a class="article-title-index" href="/post/i-am-wang-zhandou/"><strong>我叫王战斗</strong></a>
      <small class="article-date-index">&nbsp; 2018-07-01</small>
      <!--<a>
      <div = post.date  </div>
      </a>-->
      <br>
      <br> <!-- blair add -->
    </myh11>
  


      </header>
    
    <div class="article-meta">
      <!--<a href="/post/i-am-wang-zhandou/" class="article-date">
  <time datetime="2018-07-01T08:46:32.000Z" itemprop="datePublished">2018-07-01</time>
</a>-->
      <!--
  <div class="article-category-index">
    <a class="article-category-index-link" href="/categories/青梅煮酒/">青梅煮酒</a>
  </div>

-->
      <!--
      
        <div class="article-comment-link-wrap">
          <a href="http://0x3f.org/post/i-am-wang-zhandou/#disqus_thread" class="article-comment-link">Comments</a>
        </div>
      
      -->
    </div>
	
    <div class="article-entry" itemprop="articleBody">
      
        <p>我叫王战斗，男，喵星人，狸花族，现年四个半月，折合成你们两脚兽的年龄算7岁了。</p>
<p>虽然刚降临你星不久，但是我已经能驯服和驾驭两脚兽这种低等生物了。因为我发现这种生物本性里有一个致命弱点：对它很好反而不会珍惜，故作高冷却奴颜婢膝求抱抱！我们喵星管这叫「贱」。</p>
<p>开始的时候，我的驭兽术还不熟练，而且我酷爱往两脚兽的脖子里钻，然后蹭它们的脸。结果它们不干了，在我才两个月零九天的时候就把我交给了现在这头两脚兽。是它们不懂喵星习俗好不好？！而且作为一个刚断奶的小正太，卖个萌怎么啦，怪我咯？</p>
<p>我一直在暗中观察现在这头两脚兽。发现每隔五天，它都会在巢穴里待上两天，然后在接下来的五天里每天都消失一段时间。虽然有点好奇，不过也不是什么大事，只要我有吃有喝、两脚兽按时铲屎，每天给它放个风什么的我也OK，这是我们喵星高等生物的自我修养。</p>
<p>不过还是要测试一下这货的驯服度。所以我命令它伺候我睡个午觉：<br><img src="https://wx4.sinaimg.cn/large/006tNbRwly1fwvx0d5683j31kw1kwb29.jpg" alt=""></p>
<p>这货竟然没有反抗！！！</p>
<p>有一天我发现它竟然在偷看我练习家传绝学「黑虎掏心」，我就瞪它，就瞪它：<br><img src="https://wx1.sinaimg.cn/large/006tNbRwly1fwvx0z5chyj31ei1ei4qp.jpg" alt=""></p>
<p>有时候两脚兽全神贯注地照镜子，我就想看看它看的啥，然后它就扒拉我，我想一定是我高大威猛的身躯挡住它了：<br><img src="https://wx4.sinaimg.cn/large/006tNbRwly1fwvx1dzxegj31kw16okjm.jpg" alt=""></p>
<p>这老头叫马霸霸，挺能白话的，它的巢穴已经被我军占领了：<br><img src="https://wx1.sinaimg.cn/large/006tNbRwly1fwvx1v8jh3j31kw1kwhdu.jpg" alt=""></p>
<p>那天两脚兽带回来一只老鼠，我一眼就看出来是假的，但是这货一碰就叫啊，然后我就停不下来了，你星管这叫口嫌体正直，看著两脚兽谜之微笑，我觉得中了奸计：<br><img src="https://wx4.sinaimg.cn/large/006tNbRwly1fwvx2fq5ltj30sz0prq8x.jpg" alt=""></p>
<p>更有甚者，它竟然趁我睡著的时候拍我裸照，还传到网上：<br><img src="https://wx1.sinaimg.cn/large/006tNbRwly1fwvx2ix4jej31kw23ve84.jpg" alt=""></p>
<p>生亦何欢，死亦何惧。趁两脚兽上厕所的时候，叼走了卷纸，然后撕稀碎，有能耐学我们喵星人上完厕所自己舔干净啊？！<br><img src="https://wx2.sinaimg.cn/large/006tNbRwly1fwvx2zgpawj31kw1kw1kz.jpg" alt=""></p>
<p>没想到报复来得如此突然，两脚兽不知道从哪儿搞了一瓶毒气，走到哪儿揣到哪儿，我一想搞事情就各种喷：<br><img src="https://wx4.sinaimg.cn/large/006tNbRwly1fwvx332k34j30lc0sgn0a.jpg" alt=""></p>
<p>真臭啊，臭到怀疑喵生啊！<br><img src="https://wx1.sinaimg.cn/large/006tNbRwly1fwvx3jj4ktj31kw23v1kz.jpg" alt=""></p>
<p>话说回来，大部分时间两脚兽还是没那么讨厌。比如这个会喷水的盒子，被我霸占后就成了我最常喝水的东西兼洗脚盆：<br><img src="https://wx3.sinaimg.cn/large/006tNbRwly1fwvxatojbkj31260v9k0s.jpg" alt=""></p>
<p>两脚兽的厨艺也不赖：<br><img src="https://wx3.sinaimg.cn/large/006tNbRwly1fwvxb51icjj31kw1kw1kz.jpg" alt=""></p>
<p>吹嘘自己慷慨的时候，两脚兽就指著这口袋说：「比我吃得都好。」其实就是618的打折货。<br><img src="https://wx3.sinaimg.cn/large/006tNbRwly1fwvx61t9ogj31kw1kw1kz.jpg" alt=""></p>
<p>两脚兽就是个肥宅兼Nerd，且不说为了给我做饭专门买了台电动切碎机和保鲜盒。铲个屎都装绝命毒师：<br><img src="https://wx2.sinaimg.cn/large/006tNbRwly1fwvx6f8zwzj31kw14fhdv.jpg" alt=""></p>
<p>某天整了把稀奇古怪的东西在床上、沙发上各种吸，完事非要说是我干的：<br><img src="https://wx2.sinaimg.cn/large/006tNbRwly1fwvx709q7qj31kw16o4qq.jpg" alt=""></p>
<p>我的天啊！不就掉个毛么，全宇宙只有你们两脚兽光著屁股满世界跑！<br><img src="https://wx1.sinaimg.cn/large/006tNbRwly1fwvx75b1f9j31kw1kw7wi.jpg" alt=""></p>
<p>我来，我见，我征服。我是王战斗，一个普通的驯兽师。<br><img src="https://wx3.sinaimg.cn/large/006tNbRwly1fwvx7kbr2hj30sg0sg0zr.jpg" alt=""></p>

      
    </div>
	
    <!--
	
    -->
    <!--
    
      <footer class="article-footer">
      </footer>
    
    -->
  </div>
  
</article>



    
      <article id="post-pdf-creating-solutions" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <myh11 itemprop="name">
      <a class="article-title-index" href="/post/pdf-creating-solutions/"><strong>生成PDF的方案调研</strong></a>
      <small class="article-date-index">&nbsp; 2018-05-16</small>
      <!--<a>
      <div = post.date  </div>
      </a>-->
      <br>
      <br> <!-- blair add -->
    </myh11>
  


      </header>
    
    <div class="article-meta">
      <!--<a href="/post/pdf-creating-solutions/" class="article-date">
  <time datetime="2018-05-16T07:41:36.000Z" itemprop="datePublished">2018-05-16</time>
</a>-->
      <!--
  <div class="article-category-index">
    <a class="article-category-index-link" href="/categories/计算机/">计算机</a>
  </div>

-->
      <!--
      
        <div class="article-comment-link-wrap">
          <a href="http://0x3f.org/post/pdf-creating-solutions/#disqus_thread" class="article-comment-link">Comments</a>
        </div>
      
      -->
    </div>
	
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="结论"><a href="#结论" class="headerlink" title="结论"></a>结论</h2><p>倾向于通过wkhtmltopdf+消息队列实现。</p>
<p>工作流程：</p>
<ol>
<li>用户保存表单</li>
<li>推送生成pdf的任务到队列</li>
<li>同时页面显示「正在生成PDF文档，请稍候」并轮询后端接口</li>
<li>PDF生成后，页面显示下载按钮</li>
</ol>
<h2 id="后端"><a href="#后端" class="headerlink" title="后端"></a>后端</h2><h3 id="dompdf"><a href="#dompdf" class="headerlink" title="dompdf"></a>dompdf</h3><p>纯PHP实现。工作原理是把HTML转换成PDF。</p>
<p>优点：</p>
<ol>
<li>不需要PHP调用命令行，安全性高。</li>
</ol>
<p>缺点：</p>
<ol>
<li>HTML/CSS支持不完全，实测多个网页转换后排版错乱。</li>
<li>中文网页转换后，中文都是问号（网上说有解决办法<a href="http://www.cnblogs.com/xxoome/p/6083542.html" target="_blank" rel="noopener">1</a>、<a href="http://blog.51cto.com/lampzxr/1916038" target="_blank" rel="noopener">2</a>，未测试）。</li>
<li>CPU占用比较高（网上的说法，没有实测具体有多高）。</li>
</ol>
<p>参考：</p>
<ul>
<li><a href="https///github.com/barryvdh/laravel-dompdf">laravel-dompdf主页</a></li>
</ul>
<h3 id="mpdf"><a href="#mpdf" class="headerlink" title="mpdf"></a>mpdf</h3><p>纯PHP实现。工作原理是把HTML转换成PDF。</p>
<p>优点：</p>
<ol>
<li>不需要PHP调用命令行，安全性高。</li>
</ol>
<p>缺点（未实测）：</p>
<ol>
<li>HTML/CSS支持不完整。</li>
<li>生成PDF耗时长。</li>
</ol>
<p>参考：</p>
<ul>
<li><a href="https///github.com/niklasravnsborg/laravel-pdf">laravel-pdf主页</a></li>
<li><a href="https///mpdf.github.io">mpdf文档</a></li>
<li><a href="https///github.com/mpdf/mpdf">mpdf主页</a></li>
<li><a href="http://www.cnblogs.com/attitudeY/p/7297948.html" target="_blank" rel="noopener">mpdf与fpdf的使用比较</a></li>
</ul>
<h3 id="PDFtk-Server"><a href="#PDFtk-Server" class="headerlink" title="PDFtk Server"></a>PDFtk Server</h3><p>PDFtk Server是个命令行程序。工作原理是利用FDF表单替换PDF模板中的占位符。实现方案有：纯PHP实现FDF + PDFtk、FPDI + PDFtk。</p>
<p>优点：</p>
<ol>
<li>直接替换PDF模板，实现成本低，最大程度保证生成的PDF的效果。</li>
</ol>
<p>缺点：</p>
<ol>
<li>需要允许PHP调用命令行，有安全隐患。</li>
<li>只能实现简单的字符串替换（例如公司名称），不能替换有格式文本。</li>
</ol>
<p>参考：</p>
<ul>
<li><a href="https///www.setasign.com/products/fpdi/manual/#p-58">FPDI</a></li>
<li><a href="http://php.net/manual/zh/intro.fdf.php" target="_blank" rel="noopener">PHP的FDF手册</a></li>
<li><a href="https///stackoverflow.com/questions/1389964/merge-fdf-data-into-a-pdf-file-using-php">PDFtk的使用方法</a></li>
<li><a href="https///www.sitepoint.com/filling-pdf-forms-pdftk-php/">纯PHP实现FDF + PDFtk</a></li>
</ul>
<h3 id="wkhtmltopdf"><a href="#wkhtmltopdf" class="headerlink" title="wkhtmltopdf"></a>wkhtmltopdf</h3><p>wkhtmltopdf是个命令行程序。工作原理是转换HTML到PDF。实现方案是laravel-snappy。</p>
<p>优点：</p>
<ol>
<li>由于内嵌webkit核心，HTML/CSS的支持没有问题。</li>
</ol>
<p>缺点：</p>
<ol>
<li>需要允许PHP调用命令行，有安全隐患。</li>
<li>wkhtmltopdf体积40M，并发较多时影响服务器性能和稳定性（需要考虑用队列辅助实现，异步执行，需要需求变更交互方式）。</li>
</ol>
<p>参考：</p>
<ul>
<li><a href="https///github.com/barryvdh/laravel-snappy">laravel-snappy主页</a></li>
</ul>
<h3 id="CutyCapt"><a href="#CutyCapt" class="headerlink" title="CutyCapt"></a>CutyCapt</h3><p>命令行程序。工作原理和wkhtmtopdf相同。</p>
<p>优缺点同wkhtmltopdf，但是最近的更新在13年。</p>
<p>参考：</p>
<ul>
<li><a href="http://cutycapt.sourceforge.net" target="_blank" rel="noopener">CutyCapt主页</a></li>
</ul>
<h3 id="Prince"><a href="#Prince" class="headerlink" title="Prince"></a>Prince</h3><p>命令行程序。工作原理是转换HTML到PDF。</p>
<p>优点：</p>
<ol>
<li>HTML/CSS的支持很好。</li>
<li>文档很全</li>
</ol>
<p>缺点：</p>
<ol>
<li>收费，而且很贵。（免费版会在输出的文档右上角打一个Logo）</li>
<li>需要允许PHP执行命令行，有安全隐患。</li>
<li>需要考虑用队列辅助实现，异步执行，需要需求变更交互方式。</li>
</ol>
<p>参考：</p>
<ul>
<li><a href="https///www.princexml.com">Prince官网</a></li>
</ul>
<h2 id="前端"><a href="#前端" class="headerlink" title="前端"></a>前端</h2><h3 id="jsPDF"><a href="#jsPDF" class="headerlink" title="jsPDF"></a>jsPDF</h3><p>工作原理有两种：编程方式动态生成和转换HTML到PDF。有三个插件支持转换HTML到PDF：fromHTML、addHTML和html2pdf。</p>
<p>fromHTML最老，优点是直接转换HTML到PDF，缺点是对复杂的HTML/CSS支持得不好。实测结果，UTF-8编码的中文网页，转换到PDF都是乱码。</p>
<p>addHTML较新，但目前处于deprecated状态，利用html2canvas/rasterizeHTML创建一个canvas，然后把HTML转换成图片、再转换成PDF。实测结果，对中文网页和CSS支持得都不错，但是对分页支持得不好，指定分页选项后图片被拉伸并强行分割，很难看。</p>
<p>html2pdf是正在开发的功能，还没完成。</p>
<p>参考：</p>
<ul>
<li><a href="https://stackoverflow.com/questions/44778260/what-are-the-differences-between-jspdfs-methods-addhtml-and-fromhtml" target="_blank" rel="noopener">https://stackoverflow.com/questions/44778260/what-are-the-differences-between-jspdfs-methods-addhtml-and-fromhtml</a></li>
</ul>
<h3 id="pdfkit"><a href="#pdfkit" class="headerlink" title="pdfkit"></a>pdfkit</h3><p>只能通过编程（//调用接口指定内容、分页等相关属性//）生成PDF，不支持从HTML转换到PDF。</p>
<h3 id="pdfmake"><a href="#pdfmake" class="headerlink" title="pdfmake"></a>pdfmake</h3><p>据说扩展自pdfkit。只能通过编程（//调用接口指定内容、分页等相关属性//）生成PDF，不支持从HTML转换到PDF。而且需要引用字体文件转换成的js文件，不适合中文内容。</p>
<h2 id="变通方案"><a href="#变通方案" class="headerlink" title="变通方案"></a>变通方案</h2><h3 id="利用浏览器打印PDF"><a href="#利用浏览器打印PDF" class="headerlink" title="利用浏览器打印PDF"></a>利用浏览器打印PDF</h3><p>Chrome、Firefox、Safari的最新版都支持打印网页到PDF，Edge未测试。</p>
<p>优点：</p>
<ol>
<li>实现成本低。</li>
</ol>
<p>缺点：</p>
<ol>
<li>用户体验差。</li>
</ol>
<h3 id="导出word文档"><a href="#导出word文档" class="headerlink" title="导出word文档"></a>导出word文档</h3><p>优点：</p>
<ol>
<li>实现成本低。（未证实）</li>
</ol>
<p>缺点：</p>
<ol>
<li>用户可更改文档。</li>
</ol>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul>
<li><a href="https://blog.stahlmandesign.com/export-html-to-pdf-how-hard-can-it-be/" target="_blank" rel="noopener">https://blog.stahlmandesign.com/export-html-to-pdf-how-hard-can-it-be/</a></li>
<li><a href="https///my.oschina.net/janpoem/blog/705912">PHP输出PDF打印HTML5+CSS3打印格式控制(Prince和wkhtmltopdf)</a></li>
</ul>

      
    </div>
	
    <!--
	
    -->
    <!--
    
      <footer class="article-footer">
      </footer>
    
    -->
  </div>
  
</article>



    
      <article id="post-after-reading-killing-commendatore" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <myh11 itemprop="name">
      <a class="article-title-index" href="/post/after-reading-killing-commendatore/"><strong>少不读村上</strong></a>
      <small class="article-date-index">&nbsp; 2018-04-22</small>
      <!--<a>
      <div = post.date  </div>
      </a>-->
      <br>
      <br> <!-- blair add -->
    </myh11>
  


      </header>
    
    <div class="article-meta">
      <!--<a href="/post/after-reading-killing-commendatore/" class="article-date">
  <time datetime="2018-04-22T05:55:00.000Z" itemprop="datePublished">2018-04-22</time>
</a>-->
      <!--
  <div class="article-category-index">
    <a class="article-category-index-link" href="/categories/青梅煮酒/">青梅煮酒</a>
  </div>

-->
      <!--
      
        <div class="article-comment-link-wrap">
          <a href="http://0x3f.org/post/after-reading-killing-commendatore/#disqus_thread" class="article-comment-link">Comments</a>
        </div>
      
      -->
    </div>
	
    <div class="article-entry" itemprop="articleBody">
      
        <p>读完了《刺杀骑士团长》。</p>
<p>开始一直以为是类似《禁闭岛》那样的表达手法，觉得当个悬疑的故事看也不错，结果直到最后一页，才发现连装神弄鬼都不是，顿时觉得六十块钱花得有点冤。单从表达手法上说，不喜欢神神叨叨的东西。凭著炒魔幻现实主义的冷饭得诺奖怕是不大可能。</p>
<p>故事的大致情节是：生活平淡的画家，突遇婚变，逃避现实的过程中经历一系列魔幻和现实交错的事，最后解开心结，回到现实，找到救赎。</p>
<p>这本书要表达的东西很多，出现的每一个主体都存在于多条叙事线中，只粗略读过一遍，大概也就理解了个皮毛。最主要的，是两个概念和五幅画。</p>
<p>两个概念，分别是「理念」和「隐喻」。</p>
<p>理念是人在自我审视下出现的另一个「我」，包括善的和恶的。象征善的理念的是「骑士团长」，一个时隐时现、身高60厘米的古代日本武士形象。象征恶的理念的是「白色斯巴鲁男子」，随时提醒「我」：你的恶，我都知道。</p>
<p>隐喻是人生各种经历的具象化的形象。</p>
<p>五幅画，分别是《刺杀骑士团长》、《免色肖像画》、《白色斯巴鲁男子》、《杂木林中的洞穴》和《真理惠肖像画》。</p>
<p>《刺杀骑士团长》的作用很多。首先，从这幅画引出被遗忘的二战中的往事，包括雨田具彦在奥地利和雨田继彦在南京的遭遇。其次，骑士团长于「我」，是善的理念的象征，于雨田具彦，是隐藏数十年挥之不去的心结。第三，最终「我」刺杀了骑士团长，一方面解了雨田具彦的心结，使其安详地离世，另一方面，这是「我」进入隐喻世界的前提，也是解救真理惠的必要条件。</p>
<p>《白色斯巴鲁男子》象征「我」的恶的理念，也是所有人的恶的理念。</p>
<p>《免色肖像画》引出免色这个重要角色。免色是个从世俗的各方面看都臻于完美的男人，然而这幅画真正打动他的，恰恰是表现出了那些深藏的、消极的、恶的不完美的东西。</p>
<p>《杂木林中的洞穴》既是魔幻的开端，也是魔幻的终点。一切魔幻的开始，源于深夜中听到的铃声。而「我」穿过隐喻世界，逃回现实世界，也发生在这个洞里。</p>
<p>《真理惠肖像画》。真理惠既是「我」的妹妹「路」的替身，也是免色的心结。「我」通过刺杀骑士团长、穿过隐喻世界「解救」了真理惠，实际上解开了对「路」早逝的心结。</p>
<p>很多年前读过《挪威的森林》，沮丧得要命，那时就认为少不读村上春树，至今如故。</p>

      
    </div>
	
    <!--
	
    -->
    <!--
    
      <footer class="article-footer">
      </footer>
    
    -->
  </div>
  
</article>



    
      <article id="post-beautify-squrrel-input-method" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <myh11 itemprop="name">
      <a class="article-title-index" href="/post/beautify-squrrel-input-method/"><strong>鼠须管的美化</strong></a>
      <small class="article-date-index">&nbsp; 2018-04-21</small>
      <!--<a>
      <div = post.date  </div>
      </a>-->
      <br>
      <br> <!-- blair add -->
    </myh11>
  


      </header>
    
    <div class="article-meta">
      <!--<a href="/post/beautify-squrrel-input-method/" class="article-date">
  <time datetime="2018-04-21T12:52:42.000Z" itemprop="datePublished">2018-04-21</time>
</a>-->
      <!--
  <div class="article-category-index">
    <a class="article-category-index-link" href="/categories/计算机/">计算机</a>
  </div>

-->
      <!--
      
        <div class="article-comment-link-wrap">
          <a href="http://0x3f.org/post/beautify-squrrel-input-method/#disqus_thread" class="article-comment-link">Comments</a>
        </div>
      
      -->
    </div>
	
    <div class="article-entry" itemprop="articleBody">
      
        <p>效果如下：<br><img src="https://wx2.sinaimg.cn/large/006tNbRwly1fwvx9h8tgtj30n20bqaah.jpg" alt="Ulysses_2018-04-21 20-43-42@2x"></p>
<p>尽管鼠须管的Github仓库一直在更新，但释出版已经很久没有更新了，所以下面的美化基于网络上个人编译的版本。<a href="https://scomper.me/gtd/-shu-xu-guan-de-diao-jiao-bi-ji" target="_blank" rel="noopener">这篇文章</a>里有该版本和「花园明朝」字体的下载链接，按照文中的说明替换鼠须管的程序。（<em>注意：官方当前释出版本鼠须管不支持下文通过patch自定义配置的方式，会造成原配置信息丢失。也不支持图示的样式。</em>）</p>
<p>然后参考<a href="https://scomper.me/gtd/shu-xu-guan-shu-ru-fa-de-xin-pei-se" target="_blank" rel="noopener">这篇文章</a>，把新的颜色方案移植到用户配置中。</p>
<p>图示样式使用「dust」方案。原色彩方案的字体设置的有点小，需要把font_point和label_font_point分别从14和10修改成18和14。原方案的第一顺序字体是「HYQiHei-55S Book」，要使用图示的花园明朝字体，可以不安装或者从配置信息中去掉该字体。由于原方案中已存在的配置项不能通过patch的方式覆盖，所以只能直接修改squirrel.yaml文件。</p>

      
    </div>
	
    <!--
	
    -->
    <!--
    
      <footer class="article-footer">
      </footer>
    
    -->
  </div>
  
</article>



    
      <nav id="page-nav">
        <a class="extend prev" rel="prev" href="/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/41/">41</a><a class="extend next" rel="next" href="/page/3/">Next &raquo;</a>
      </nav>
    

</section>
    <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2020 晴耕雨讀&nbsp;
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>, theme by <a href="http://github.com/52binge/hexo-theme-blairos">blairos</a>
    </div>
  </div>
</footer>

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX"],
    tex2jax: {
      inlineMath: [ ['$','$'], ['\\(','\\)'] ],
      displayMath: [ ['$$','$$']],
      processEscapes: true
    }
  });
</script>
<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML,http://myserver.com/MathJax/config/local/local.js">
</script>

    
<script type="text/javascript"> <!-- add by blair 0724 type=text/javascript -->
  var disqus_shortname = '0x3f';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="/js/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>
