<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">
  
  <title>晴耕雨讀</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="晴耕雨讀">
<meta property="og:url" content="http://0x3f.org/page/36/index.html">
<meta property="og:site_name" content="晴耕雨讀">
<meta property="og:locale" content="zh-TW">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="晴耕雨讀">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link href="/webfonts/ptserif/main.css" rel="stylesheet" type="text/css">
  <link href="/webfonts/source-code-pro/main.css" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/css/style.css">
  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-93233020-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


</head>
</html>
<body>
  <div id="container">
    <!-- blair add baidu tongji start... @2017.10.03 -->
<!-- blair add baidu tongji end ! @2017.10.03 -->

<header id="header">
  <div id="header-outer" class="outer">
    <div id="header-inner" class="inner">
      <a id="main-nav-toggle" class="nav-icon" href="javascript:;"></a>
      <a id="logo" class="logo" href="/"></a>
      <nav id="main-nav">
        
          <a class="main-nav-link" href="/archives">目录</a>
        
          <a class="main-nav-link" href="/categories">分类</a>
        
          <a class="main-nav-link" href="/tags">标签</a>
        
          <a class="main-nav-link" href="https://t.me/s/blingings">不灵</a>
        
          <a class="main-nav-link" href="/about">关于</a>
        
      </nav>
      <nav id="sub-nav">
        <div id="search-form-wrap">
          <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://0x3f.org"></form>
        </div>
      </nav>
    </div>
  </div>
</header>

    <br>
    <section id="main" class="outer">
      <article id="post-wp-batchcat" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <myh11 itemprop="name">
      <a class="article-title-index" href="/post/wp-batchcat/"><strong>WordPress Plugin: Batch Cat</strong></a>
      <small class="article-date-index">&nbsp; 2010-09-04</small>
      <!--<a>
      <div = post.date  </div>
      </a>-->
      <br>
      <br> <!-- blair add -->
    </myh11>
  


      </header>
    
    <div class="article-meta">
      <!--<a href="/post/wp-batchcat/" class="article-date">
  <time datetime="2010-09-03T16:00:00.000Z" itemprop="datePublished">2010-09-04</time>
</a>-->
      <!--
-->
      <!--
      
        <div class="article-comment-link-wrap">
          <a href="http://0x3f.org/post/wp-batchcat/#disqus_thread" class="article-comment-link">Comments</a>
        </div>
      
      -->
    </div>
	
    <div class="article-entry" itemprop="articleBody">
      
        <p><a href="http://picasaweb.google.com/lh/photo/bqYPszwt0P7OI9snKxv3WA?feat=embedwebsite" target="_blank" rel="noopener"><img src="http://lh3.ggpht.com/_ceUJ_lBTHzc/TIIMnE-09dI/AAAAAAAABdk/q_hDtyXJozo/s800/wp-batch-cat.png"></a></p>
<h3>Introduction</h3>

<p>Batch Cat is intended to help users change categories of posts in bulk.</p>
<p>The main features are:</p>
<ol><br>    <li>Assign the selected categories to posts.</li><br>    <li>Append the selected categories to posts.</li><br>    <li>Delete the selected categories from posts.</li><br>    <li>Intuitionistic operating manners which come up with people’s common practice.</li><br>    <li>Configurable number of posts listed in one page.</li><br>    <li>Slimming but enough searching and sorting options.</li><br>    <li>More in the future.</li><br></ol>

<h3>Screenshot</h3>

<p><a href="http://picasaweb.google.com/lh/photo/HbcUjNJ5wuK_XtIUxw1GWw?feat=embedwebsite" target="_blank" rel="noopener"><img src="http://lh3.ggpht.com/_ceUJ_lBTHzc/TIIK1-R9vDI/AAAAAAAABdc/18irrESzXok/s400/wordpress_plugin-batch_cat.png"></a></p>
<h3>Installation &amp; Usage</h3>

<p>As usual, upload the folder of Batch Cat to the wordpress plugin directory, activate it then.</p>
<p>You can perform operations in the page which lies in <b>Tools-&gt;Batch Cat</b> in the admin panel.</p>
<p>To alter settings of this plugin, go to <b>Settings-&gt;Batch Cat Settings</b>.</p>
<h3>Download</h3>

<p>Batch Cat is now hosted in the wordpress plugin repository:</p>
<p><a href="http://wordpress.org/extend/plugins/batch-cat/" target="_blank" rel="noopener">http://wordpress.org/extend/plugins/batch-cat/</a></p>
<h3>Wish List</h3>

<ol><br><li>I18N</li><br><li>More search options</li><br><li>More information in the post list</li><br></ol>

<h3>Change Log</h3>

<blockquote><br><strong>2011-03-20 Sunday</strong><br><ol><br>    <li>Solve the compatibility <a href="http://wordpress.org/support/topic/plugin-batch-cat-doesnt-work-for-31" target="_blank" rel="noopener">problem</a> under Wordpress 3.1, thanks to <a href="http://coliq.wongkediri.com/batch-cat-wordpress-plugin-not-working-fixed.html" target="_blank" rel="noopener">wongkediri</a>.</li><br></ol><br></blockquote>

<blockquote><br><strong>2010-12-12 Sunday</strong><br><ol><br>    <li>Add the ability to append the selected categories to posts</li><br>    <li>Add the ability to delete the selected categories from posts</li><br></ol><br></blockquote>

<blockquote><br><b>2010-09-04 Saturday</b><br>Initial release.<br></blockquote>

      
    </div>
	
    <!--
	
    -->
    <!--
    
      <footer class="article-footer">
      </footer>
    
    -->
  </div>
  
</article>



    
      <article id="post-after-reading-wordpress-plug-in-development" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <myh11 itemprop="name">
      <a class="article-title-index" href="/post/after-reading-wordpress-plug-in-development/"><strong>读完《WordPress Plug-in Development》</strong></a>
      <small class="article-date-index">&nbsp; 2010-08-29</small>
      <!--<a>
      <div = post.date  </div>
      </a>-->
      <br>
      <br> <!-- blair add -->
    </myh11>
  


      </header>
    
    <div class="article-meta">
      <!--<a href="/post/after-reading-wordpress-plug-in-development/" class="article-date">
  <time datetime="2010-08-28T16:00:00.000Z" itemprop="datePublished">2010-08-29</time>
</a>-->
      <!--
-->
      <!--
      
        <div class="article-comment-link-wrap">
          <a href="http://0x3f.org/post/after-reading-wordpress-plug-in-development/#disqus_thread" class="article-comment-link">Comments</a>
        </div>
      
      -->
    </div>
	
    <div class="article-entry" itemprop="articleBody">
      
        <p>花了两天时间读完了《WordPress Plug-in Development》，通过实例讲解，很细致，适合用来入门，当然，深度和广度都有限。</p>
<p><a href="http://picasaweb.google.com/lh/photo/k7nT3M9jrDW1dPv-nzKJvQ?feat=embedwebsite" target="_blank" rel="noopener"><img src="http://lh4.ggpht.com/_ceUJ_lBTHzc/THnN7TJZDlI/AAAAAAAABdI/OBmuprXqpX4/s400/wordpress-plugin-development.jpg"></a></p>

      
    </div>
	
    <!--
	
    -->
    <!--
    
      <footer class="article-footer">
      </footer>
    
    -->
  </div>
  
</article>



    
      <article id="post-a-bash-script-downloading-videos-in-batch" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <myh11 itemprop="name">
      <a class="article-title-index" href="/post/a-bash-script-downloading-videos-in-batch/"><strong>批量下载视频的BASH脚本</strong></a>
      <small class="article-date-index">&nbsp; 2010-08-28</small>
      <!--<a>
      <div = post.date  </div>
      </a>-->
      <br>
      <br> <!-- blair add -->
    </myh11>
  


      </header>
    
    <div class="article-meta">
      <!--<a href="/post/a-bash-script-downloading-videos-in-batch/" class="article-date">
  <time datetime="2010-08-27T16:00:00.000Z" itemprop="datePublished">2010-08-28</time>
</a>-->
      <!--
-->
      <!--
      
        <div class="article-comment-link-wrap">
          <a href="http://0x3f.org/post/a-bash-script-downloading-videos-in-batch/#disqus_thread" class="article-comment-link">Comments</a>
        </div>
      
      -->
    </div>
	
    <div class="article-entry" itemprop="articleBody">
      
        <p>两周前为了批量下载某视频网站中的电视剧，写了个BASH脚本。将电视剧列表页面的URL地址作为唯一参数传给脚本，然后就会把所有视频下载到当前目录下，并自动重命名，同时生成一个M3U格式的播放列表。</p>
<p>由于在线视频不支持断点续传，所以对于单个视频来说无法实现。但对于整个批量下载任务来说，实现了宏观上的断点续传，已经下载的视频不会被重复下载。由于有些视频网站会在午夜更改视频地址，所以这一点很有用。</p>
<p>主流视频网站应该是都支持的，我只测试了我下载电视剧的网站，<strong>不支持的都是非主流的！</strong></p>
<p>唯一可能需要注意的依赖是PHP，必须安装后才能使用。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">print_help_msg</span></span> () &#123;</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"You see, I'm nothing ."</span></span><br><span class="line">    <span class="built_in">exit</span> 0</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">check_param</span></span> () &#123;</span><br><span class="line">    <span class="keyword">if</span> [ <span class="variable">$#</span> -ne 1 ]; <span class="keyword">then</span></span><br><span class="line">        print_help_msg</span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">check_m3u</span></span> () &#123;</span><br><span class="line">    <span class="keyword">if</span> ! [ -a p.m3u ] || [ `wc -l p.m3u|awk <span class="string">'&#123; print $1 &#125;'</span>` -eq 0 ]; <span class="keyword">then</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">'#EXTM3U'</span> &gt; p.m3u</span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">check_param $*</span><br><span class="line">check_m3u</span><br><span class="line"></span><br><span class="line"><span class="built_in">export</span> LC_ALL=en_US.UTF-8</span><br><span class="line"></span><br><span class="line">ue=$(php -r <span class="string">"echo urlencode('<span class="variable">$1</span>');"</span>)</span><br><span class="line">parser=<span class="string">"http://www.flvcd.com/parse.php?flag=&amp;format=&amp;kw=<span class="variable">$ue</span>&amp;sbt=%BF%AA%CA%BCGO%21"</span></span><br><span class="line"><span class="keyword">if</span> ! wget <span class="variable">$parser</span> -U mozilla -O meta.html ; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"Unable to touch the parser, check network status for the cause ."</span></span><br><span class="line">    <span class="built_in">exit</span> 0</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line">grep <span class="string">"&lt;N&gt;"</span> meta.html &gt; title.lst</span><br><span class="line">grep <span class="string">"&lt;U&gt;"</span> meta.html &gt; url.lst</span><br><span class="line">iconv -f gbk -t utf-8 title.lst -o title.lst</span><br><span class="line">sed -i <span class="string">'s/&lt;N&gt;//g'</span> title.lst</span><br><span class="line">sed -i <span class="string">'s/ //g'</span> title.lst</span><br><span class="line">sed -i <span class="string">'s/&lt;U&gt;//g'</span> url.lst</span><br><span class="line"></span><br><span class="line">l1=`wc -l title.lst|awk <span class="string">'&#123; print $1 &#125;'</span>`</span><br><span class="line">l2=`wc -l url.lst|awk <span class="string">'&#123; print $1 &#125;'</span>`</span><br><span class="line"><span class="keyword">if</span> [ <span class="string">"<span class="variable">$l1</span>"</span> != <span class="string">"<span class="variable">$l2</span>"</span> ]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"Title.lst has <span class="variable">$l1</span> lines, but url.lst got <span class="variable">$l2</span>."</span></span><br><span class="line">    <span class="built_in">exit</span> 0</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$l1</span> -eq 0 ]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"Nothing got from the parser, check meta.html for detail info."</span></span><br><span class="line">    <span class="built_in">exit</span> 0</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line">arrTitle=(`cat title.lst`)</span><br><span class="line">arrURL=(`cat url.lst`)</span><br><span class="line"></span><br><span class="line">idx=$((`wc -l p.m3u|awk <span class="string">'&#123; print $1 &#125;'</span>`-1))</span><br><span class="line"><span class="keyword">while</span> [ <span class="variable">$idx</span> -lt <span class="variable">$l1</span> ]; <span class="keyword">do</span></span><br><span class="line">    title=<span class="variable">$&#123;arrTitle[$idx]&#125;</span></span><br><span class="line">    url=<span class="variable">$&#123;arrURL[$idx]&#125;</span></span><br><span class="line">    idx=$((idx+1))</span><br><span class="line">    <span class="keyword">if</span> ! wget <span class="variable">$url</span> -U mozilla -O <span class="string">"<span class="variable">$&#123;title&#125;</span>.flv"</span> ; <span class="keyword">then</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">"Failed fetching <span class="variable">$&#123;title&#125;</span>.flv, maybe its URL has been changed !"</span></span><br><span class="line">        <span class="built_in">exit</span> 0</span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">    cmd=<span class="string">"sed -i '\$a\\<span class="variable">$&#123;title&#125;</span>.flv' p.m3u"</span></span><br><span class="line">    <span class="built_in">eval</span> <span class="variable">$cmd</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">'done !'</span></span><br><span class="line"><span class="built_in">exit</span> 0</span><br></pre></td></tr></table></figure>
<p>另外，使用VLC执行播放列表效果灰常不错，视频之间衔接平滑流畅。</p>

      
    </div>
	
    <!--
	
    -->
    <!--
    
      <footer class="article-footer">
      </footer>
    
    -->
  </div>
  
</article>



    
      <article id="post-howto-auto-maximize-gvim-at-startup" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <myh11 itemprop="name">
      <a class="article-title-index" href="/post/howto-auto-maximize-gvim-at-startup/"><strong>启动GVim时自动最大化窗口的方法</strong></a>
      <small class="article-date-index">&nbsp; 2010-08-25</small>
      <!--<a>
      <div = post.date  </div>
      </a>-->
      <br>
      <br> <!-- blair add -->
    </myh11>
  


      </header>
    
    <div class="article-meta">
      <!--<a href="/post/howto-auto-maximize-gvim-at-startup/" class="article-date">
  <time datetime="2010-08-24T16:00:00.000Z" itemprop="datePublished">2010-08-25</time>
</a>-->
      <!--
-->
      <!--
      
        <div class="article-comment-link-wrap">
          <a href="http://0x3f.org/post/howto-auto-maximize-gvim-at-startup/#disqus_thread" class="article-comment-link">Comments</a>
        </div>
      
      -->
    </div>
	
    <div class="article-entry" itemprop="articleBody">
      
        <p>根据帮助文档，gvim在windows下的最大化是通过模拟打开窗口菜单并点击最大化菜单项实现的，而在Linux下的方法较为灵活。</p>
<p>下面的方法是在vim中通过调用wmctrl实现最大化的方法：</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="built_in">has</span>(<span class="string">'win32'</span>)</span><br><span class="line">    <span class="keyword">au</span> GUIEnter * <span class="keyword">simalt</span> ~<span class="keyword">x</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="keyword">au</span> GUIEnter * <span class="keyword">call</span> MaximizeWindow()</span><br><span class="line"><span class="keyword">endif</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span>! <span class="title">MaximizeWindow</span><span class="params">()</span></span></span><br><span class="line">    <span class="keyword">silent</span> !wmctrl -r :ACTIVE: -<span class="keyword">b</span> <span class="built_in">add</span>,maximized_vert,maximized_horz</span><br><span class="line"><span class="keyword">endfunction</span></span><br></pre></td></tr></table></figure>
<p>当然也可以通过配置窗口管理器规则实现自动最大化，但上面的方法更灵活。</p>

      
    </div>
	
    <!--
	
    -->
    <!--
    
      <footer class="article-footer">
      </footer>
    
    -->
  </div>
  
</article>



    
      <article id="post-howto-run-sql-scripts-in-mysql-oracle-within-installshield" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <myh11 itemprop="name">
      <a class="article-title-index" href="/post/howto-run-sql-scripts-in-mysql-oracle-within-installshield/"><strong>InstallShield在MySQL和Oracle中执行SQL脚本的方法</strong></a>
      <small class="article-date-index">&nbsp; 2010-08-24</small>
      <!--<a>
      <div = post.date  </div>
      </a>-->
      <br>
      <br> <!-- blair add -->
    </myh11>
  


      </header>
    
    <div class="article-meta">
      <!--<a href="/post/howto-run-sql-scripts-in-mysql-oracle-within-installshield/" class="article-date">
  <time datetime="2010-08-23T16:00:00.000Z" itemprop="datePublished">2010-08-24</time>
</a>-->
      <!--
-->
      <!--
      
        <div class="article-comment-link-wrap">
          <a href="http://0x3f.org/post/howto-run-sql-scripts-in-mysql-oracle-within-installshield/#disqus_thread" class="article-comment-link">Comments</a>
        </div>
      
      -->
    </div>
	
    <div class="article-entry" itemprop="articleBody">
      
        <h2>简述</h2>

<p>InstallShield已经内建了对MySQL和Oracle的支持。但是这个功能是通过ODBC实现的，它对SQL脚本的格式要求非常严格，因此已经通过官方客户端测试的脚本在IS中执行时往往就会报错。</p>
<p>一般来说，数据库脚本只保证通过官方客户端测试即可，同时维护一份供IS执行的脚本费时费力。因此，考虑安装程序对两数据库的支持通过官方客户端实现。</p>
<h2>MySQL</h2><br><br><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">function InstallMySQLComponent(szComponent)</span><br><span class="line">    NUMBER nResult;</span><br><span class="line">    STRING szServer,szDB,szUser,szPassword,sCMD,sOPT,sResult1,sResult2,svLine,sMsg,sPath;</span><br><span class="line">    NUMBER nvFileHandle,nvCount;</span><br><span class="line">    LIST listStatus;</span><br><span class="line">begin</span><br><span class="line">    sMsg = &apos;安装&apos;+szComponent+&apos; ...&apos;;</span><br><span class="line">    SdShowMsg(sMsg, TRUE);</span><br><span class="line">    // source命令不认识windows路径中的反斜杠，故将SRCDIR中的反斜杠替换成斜杠</span><br><span class="line">    sPath = SRCDIR;</span><br><span class="line">    StrReplace(sPath, &apos;\\&apos;, &apos;/&apos;, 0);</span><br><span class="line">    // Fetch database connection information</span><br><span class="line">    SQLRTGetConnectionInfo( &apos;mysql&apos;, szServer, szDB, szUser, szPassword );</span><br><span class="line">    sCMD = WINSYSDIR^&apos;cmd.exe&apos;;</span><br><span class="line">    sOPT = &apos; /c &apos;+SRCDIR^&apos;mysql.exe -h&apos;+szServer+&apos; -u&apos;+szUser+&apos; -p&apos;+szPassword+&apos; -D&apos;+szDB;</span><br><span class="line">    sOPT = sOPT+&apos; -e &quot;source &apos;+sPath^szComponent+&apos;.sql&quot; &gt; &apos;+SRCDIR^&apos;dbstatus.txt 2&gt;&amp;1&apos;;</span><br><span class="line">    // Execute the script associated with the given component in database</span><br><span class="line">    nResult=LaunchAppAndWait(sCMD, sOPT, WAIT|LAAW_OPTION_HIDDEN);</span><br><span class="line">    if (nResult &lt; 0) then</span><br><span class="line">        MessageBox(&apos;Failed installing &apos;+szComponent+&apos; !&apos;, SEVERE);</span><br><span class="line">        abort;</span><br><span class="line">    endif;</span><br><span class="line">    // 关闭安装提示</span><br><span class="line">    SdShowMsg(&apos;&apos;, FALSE);</span><br><span class="line">    // Read dbstatus.txt</span><br><span class="line">    OpenFileMode(FILE_MODE_NORMAL);</span><br><span class="line">    if (OpenFile(nvFileHandle, SRCDIR, &apos;dbstatus.txt&apos;)&lt;0) then</span><br><span class="line">        MessageBox(&apos;Failed checking the status of installing &apos;+szComponent+&apos; !&apos;, SEVERE);</span><br><span class="line">        abort;</span><br><span class="line">    endif;</span><br><span class="line">    listStatus = ListCreate(STRINGLIST);</span><br><span class="line">    while GetLine(nvFileHandle, svLine) = 0</span><br><span class="line">        ListAddString(listStatus, svLine, AFTER);</span><br><span class="line">    endwhile;</span><br><span class="line">    CloseFile(nvFileHandle);</span><br><span class="line">    // Count how many lines fetched from dbstatus.txt</span><br><span class="line">    nvCount = ListCount(listStatus);</span><br><span class="line">    if nvCount &gt; 0 then</span><br><span class="line">        sMsg = &quot;更新数据库出错，点“是”打开日志文件并退出安装，点“否”直接退出安装。\n&quot;;</span><br><span class="line">        sMsg = sMsg+&quot;若错误可忽略，可选择数据库类型“none”以跳过数据库更新并直接更新程序，\n&quot;;</span><br><span class="line">        sMsg = sMsg+&quot;然后在数据库中手工执行SQL脚本（安装后保存在script目录下）&quot;;</span><br><span class="line">        nResult = AskYesNo(sMsg, YES);</span><br><span class="line">        if (nResult = YES) then</span><br><span class="line">            LaunchApp(WINSYSDIR^&apos;notepad.exe&apos;, SRCDIR^&apos;dbstatus.txt&apos;);</span><br><span class="line">	endif;                   </span><br><span class="line">        abort;</span><br><span class="line">    endif;</span><br><span class="line">end;</span><br></pre></td></tr></table></figure><br><br><h2>Oracle</h2><br><br><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">function InstallOracleComponent(szComponent)  </span><br><span class="line">    NUMBER nResult,nvFileHandle,nIndex,nvCount;</span><br><span class="line">    STRING sMsg,szServer,szDB,szUser,szPassword,sCMD,sOPT,sInstance,sTmp,svLine;</span><br><span class="line">    LIST listStatus;</span><br><span class="line">begin</span><br><span class="line">    sMsg = &apos;安装&apos;+szComponent+&apos; ...&apos;;</span><br><span class="line">    SdShowMsg(sMsg, TRUE);</span><br><span class="line">    // Fetch database connection information</span><br><span class="line">    SQLRTGetConnectionInfo( &apos;oracle&apos;, szServer, szDB, szUser, szPassword );</span><br><span class="line">    nIndex = StrFind(szServer, &apos;:&apos;);</span><br><span class="line">    nIndex = StrFindEx(szServer, &apos;/&apos;, nIndex);</span><br><span class="line">    StrSub(sInstance, szServer, nIndex+1, 100);</span><br><span class="line">    sCMD = WINSYSDIR^&apos;cmd.exe&apos;;</span><br><span class="line">    sOPT = &apos; /c &apos;+&apos;sqlplus.exe -L -S &apos;+szUser+&apos;/&apos;+szPassword+&apos;@&apos;+sInstance;</span><br><span class="line">    sOPT = sOPT+&apos; @&apos;+SRCDIR^szComponent+&apos;.sql &gt; &apos;+SRCDIR^&apos;dbstatus.txt 2&gt;&amp;1&apos;;</span><br><span class="line">    // Execute the script associated with the given component in database</span><br><span class="line">    nResult=LaunchAppAndWait(sCMD, sOPT, WAIT|LAAW_OPTION_HIDDEN);</span><br><span class="line">    if (nResult &lt; 0) then</span><br><span class="line">        MessageBox(&apos;Failed installing &apos;+szComponent+&apos; !&apos;, SEVERE);</span><br><span class="line">        abort;</span><br><span class="line">    endif;               </span><br><span class="line">    // 关闭安装提示</span><br><span class="line">    SdShowMsg(&apos;&apos;, FALSE);</span><br><span class="line">    // 在dbstatus.txt中查询字符串holytail，如果存在，说明脚本已执行完</span><br><span class="line">    if (FileGrep(SRCDIR^&apos;dbstatus.txt&apos;, &apos;holytail&apos;, svLine, nIndex, RESTART) = 0) then</span><br><span class="line">        // 在dbstatus.txt中查询字符串ORA-，如果存在，说明脚本执行出现错误</span><br><span class="line">        if (FileGrep(SRCDIR^&apos;dbstatus.txt&apos;, &apos;ORA-&apos;, svLine, nIndex, RESTART) = 0) then</span><br><span class="line">            sMsg = &quot;更新数据库出错，点“是”打开日志文件并退出安装，点“否”直接退出安装。\n&quot;;</span><br><span class="line">            sMsg = sMsg+&quot;若错误可忽略，可选择数据库类型“none”以跳过数据库更新并直接更新程序，\n&quot;;</span><br><span class="line">            sMsg = sMsg+&quot;然后在数据库中手工执行SQL脚本（安装后保存在script目录下）&quot;;</span><br><span class="line">            nResult = AskYesNo(sMsg, YES);</span><br><span class="line">            if (nResult = YES) then</span><br><span class="line">                LaunchApp(WINSYSDIR^&apos;notepad.exe&apos;, SRCDIR^&apos;dbstatus.txt&apos;);</span><br><span class="line">            endif;                   </span><br><span class="line">            abort;</span><br><span class="line">        endif;</span><br><span class="line">    else</span><br><span class="line">        sMsg = &quot;更新数据库出错，点“是”打开日志文件并退出安装，点“否”直接退出安装。\n&quot;;</span><br><span class="line">        sMsg = sMsg+&quot;若错误可忽略，可选择数据库类型“none”以跳过数据库更新并直接更新程序，\n&quot;;</span><br><span class="line">        sMsg = sMsg+&quot;然后在数据库中手工执行SQL脚本（安装后保存在script目录下）&quot;;</span><br><span class="line">        nResult = AskYesNo(sMsg, YES);</span><br><span class="line">        if (nResult = YES) then</span><br><span class="line">            LaunchApp(WINSYSDIR^&apos;notepad.exe&apos;, SRCDIR^&apos;dbstatus.txt&apos;);</span><br><span class="line">        endif;                   </span><br><span class="line">        abort;</span><br><span class="line">    endif;</span><br><span class="line">end;</span><br></pre></td></tr></table></figure><br><br><h2>总结</h2>

<ol><br>    <li>为便于获取脚本在数据库中的执行结果，故通过官方客户端执行脚本时通过符号“<strong>&gt;</strong>”将客户端的输出信息重定向到<strong>dbstatus.txt</strong>中；同时，使用“<strong>2&gt;&amp;1</strong>”将标准错误输出重定向到标准输出设备上，当然，会进一步重定向到dbstatus.txt文件中，否则，无法获取出错信息。</li><br>    <li>sqlplus执行SQL脚本后不会自动退出，故应在Oracle的脚本后加上语句“<strong>exit;</strong>”。</li><br>    <li>重载<strong>OnSQLComponentInstalled()</strong>函数，并在其中禁止MySQL和Oracle的SQL脚本对应的Component被执行安装，然后通过以上两个函数更新数据库。</li><br></ol>

      
    </div>
	
    <!--
	
    -->
    <!--
    
      <footer class="article-footer">
      </footer>
    
    -->
  </div>
  
</article>



    
      <article id="post-howto-make-thinkpad-mute-button-detected-on-linux" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <myh11 itemprop="name">
      <a class="article-title-index" href="/post/howto-make-thinkpad-mute-button-detected-on-linux/"><strong>使Thinkpad的静音按钮能被识别的方法</strong></a>
      <small class="article-date-index">&nbsp; 2010-08-09</small>
      <!--<a>
      <div = post.date  </div>
      </a>-->
      <br>
      <br> <!-- blair add -->
    </myh11>
  


      </header>
    
    <div class="article-meta">
      <!--<a href="/post/howto-make-thinkpad-mute-button-detected-on-linux/" class="article-date">
  <time datetime="2010-08-08T16:00:00.000Z" itemprop="datePublished">2010-08-09</time>
</a>-->
      <!--
-->
      <!--
      
        <div class="article-comment-link-wrap">
          <a href="http://0x3f.org/post/howto-make-thinkpad-mute-button-detected-on-linux/#disqus_thread" class="article-comment-link">Comments</a>
        </div>
      
      -->
    </div>
	
    <div class="article-entry" itemprop="articleBody">
      
        <p>我的型号是X200，问题表现为在GNOME或XFCE下静音按钮无效，使用xev也捕获不到输入信号，而音量增加和减小按钮可以正常使用且有OSD。</p>
<p>解决办法是在grub的启动菜单中，给内核加上参数<strong>acpi_osi=“Linux”</strong>，如： </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># (0) Arch Linux</span></span><br><span class="line">title  Arch Linux</span><br><span class="line">root   (hd0,2)</span><br><span class="line">kernel /boot/vmlinuz26 root=/dev/sda3 resume=/dev/sda4 ro acpi_osi=<span class="string">"Linux"</span></span><br><span class="line">initrd /boot/kernel26.img</span><br></pre></td></tr></table></figure>
<p>从查到的资料看，<strong>acpi_osi</strong>参数是用来指定操作系统接口的，据说有些硬件都只针对Windows做了测试或优化，对于这些硬件，如果将内核的操作系统接口指定为Linux，则有可能会出问题。所以内核从2.6.23版本开始，此参数的默认值被改成了“<strong>!Linux</strong>”，以保证更广泛的兼容性和稳定性。</p>
<p>而根据<a href="http://www.thinkwiki.org/wiki/Mute_button" target="_blank" rel="noopener">这里</a>的说法，thinkpad一直以来在对Linux的兼容程度上有很好的口碑，故可以放心添加这个参数。 </p>
<p>另外，xfce下使用OSD需要安装xfce4-volumed。</p>

      
    </div>
	
    <!--
	
    -->
    <!--
    
      <footer class="article-footer">
      </footer>
    
    -->
  </div>
  
</article>



    
      <article id="post-swfdec-as-a-slim-flash-player" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <myh11 itemprop="name">
      <a class="article-title-index" href="/post/swfdec-as-a-slim-flash-player/"><strong>swfdec：简单好用的Flash播放器</strong></a>
      <small class="article-date-index">&nbsp; 2010-08-01</small>
      <!--<a>
      <div = post.date  </div>
      </a>-->
      <br>
      <br> <!-- blair add -->
    </myh11>
  


      </header>
    
    <div class="article-meta">
      <!--<a href="/post/swfdec-as-a-slim-flash-player/" class="article-date">
  <time datetime="2010-07-31T16:00:00.000Z" itemprop="datePublished">2010-08-01</time>
</a>-->
      <!--
-->
      <!--
      
        <div class="article-comment-link-wrap">
          <a href="http://0x3f.org/post/swfdec-as-a-slim-flash-player/#disqus_thread" class="article-comment-link">Comments</a>
        </div>
      
      -->
    </div>
	
    <div class="article-entry" itemprop="articleBody">
      
        <p>早在keke童鞋的<a href="http://www.imkeke.net/linux/flash-player-swfdec.html" target="_blank" rel="noopener">博客</a>上见过，直到今天下载了个flash视频教程要看时才想起来，毕竟已经不是几年前Flash很火的时候了，为了降低CPU占用，我连Chromium的Flash插件都禁用了。</p>
<p>使用后的感觉就是简单实用，有暂停，有快进，能调进度，功能一样不多，一样不少。</p>
<p>要装两个包，swfdec是解码包，swfdec-gnome是播放器。</p>
<p><a href="http://swfdec.freedesktop.org" target="_blank" rel="noopener">http://swfdec.freedesktop.org</a></p>
<p><a href="http://picasaweb.google.com/lh/photo/pBEyuoK_FQwurdii1Oekdg?feat=embedwebsite" target="_blank" rel="noopener"><img src="http://lh6.ggpht.com/_ceUJ_lBTHzc/TFWQ5SwzQnI/AAAAAAAABcc/IFg7kX6pXD4/s400/2010-08-01.23%3A17%3A32.%E6%88%AA%E5%8F%96%E9%80%89%E5%8C%BA.01.png"></a></p>

      
    </div>
	
    <!--
	
    -->
    <!--
    
      <footer class="article-footer">
      </footer>
    
    -->
  </div>
  
</article>



    
      <article id="post-howto-enable-routing-and-auto-dialing-for-unicom-adsl-modem-2" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <myh11 itemprop="name">
      <a class="article-title-index" href="/post/howto-enable-routing-and-auto-dialing-for-unicom-adsl-modem-2/"><strong>网通ADSL猫开启路由和自动拨号功能的方法之二</strong></a>
      <small class="article-date-index">&nbsp; 2010-07-18</small>
      <!--<a>
      <div = post.date  </div>
      </a>-->
      <br>
      <br> <!-- blair add -->
    </myh11>
  


      </header>
    
    <div class="article-meta">
      <!--<a href="/post/howto-enable-routing-and-auto-dialing-for-unicom-adsl-modem-2/" class="article-date">
  <time datetime="2010-07-17T16:00:00.000Z" itemprop="datePublished">2010-07-18</time>
</a>-->
      <!--
-->
      <!--
      
        <div class="article-comment-link-wrap">
          <a href="http://0x3f.org/post/howto-enable-routing-and-auto-dialing-for-unicom-adsl-modem-2/#disqus_thread" class="article-comment-link">Comments</a>
        </div>
      
      -->
    </div>
	
    <div class="article-entry" itemprop="articleBody">
      
        <p>之前提到过对华为HG522、HG527的超级用户的<a href="http://0x3f.org/?p=1528">破解方法</a>。网通附送的另一种猫，是<strong>中兴ZXV10 H108B</strong>无线猫，体积更小，而且天线是内置的。</p>
<p>上次的方法不能用在这个型号的猫上，但可以用<strong>ftp</strong>的方式破解。以下步骤基于Linux，并只在硬件版本为<strong>V1.1.02</strong>、软件版本为<strong>V1.1.02T18_N</strong>的H108B上测试通过：</p>
<ol>
<li><p>使用<strong>普通用户</strong>进入猫的设置页面并开启FTP服务，将用户名和密码均设为<strong>admin</strong></p>
</li>
<li><p>连接ftp服务器：</p>
</li>
</ol>
<blockquote><br>ftp 192.168.1.1<br></blockquote>

<p>输入用户名和密码，成功登录FTP服务器：</p>
<blockquote><br>[lenin@archer ~]$ ftp 192.168.1.1<br>Connected to 192.168.1.1.<br>220 Welcome to virtual FTP service.<br>Name (192.168.1.1:lenin): admin<br>331 Please specify the password.<br>Password:<br>230 Login successful.<br>Remote system type is UNIX.<br>Using binary mode to transfer files.<br>ftp&gt;<br></blockquote>

<ol start="3">
<li>切换到<strong>/etc</strong>目录并下载配置文件<strong>board.conf</strong>：</li>
</ol>
<blockquote><br>cd ../<br>cd etc<br>get board.conf<br></blockquote>

<p>如下所示：</p>
<blockquote><br>ftp&gt; cd ../<br>250 Directory successfully changed.<br>ftp&gt; cd etc<br>250 Directory successfully changed.<br>ftp&gt; get board.conf<br>200 PORT command successful. Consider using PASV.<br>150 Opening BINARY mode data connection for board.conf (39516 bytes).<br>226 File send OK.<br>39516 bytes received in 0.0496 seconds (796003 bytes/s)<br>ftp&gt;<br></blockquote>

<ol start="4">
<li>在下载到本地的board.conf中查找<strong>right</strong>，后跟<strong>0</strong>表示超级用户，若为<strong>1</strong>则表示普通用户，如下所示：</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">row</span> <span class="attr">id</span>=<span class="string">"0"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">item</span>&gt;</span>"right", "0"<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">item</span>&gt;</span>"username", "bjcnchgw"<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">item</span>&gt;</span>"enable", "1"<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">item</span>&gt;</span>"password", "bjcnchgw72915767"<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">row</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">row</span> <span class="attr">id</span>=<span class="string">"1"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">item</span>&gt;</span>"right", "1"<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">item</span>&gt;</span>"username", "user"<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">item</span>&gt;</span>"password", "mypasswd"<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">row</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ol start="5">
<li>在如下页面使用超级用户登录：</li>
</ol>
<blockquote><br><a href="http://192.168.1.1/cnc.html" target="_blank" rel="noopener">http://192.168.1.1/cnc.html</a><br></blockquote>

<ol start="6">
<li>进入“<strong>网络</strong>”→“<strong>宽带设置</strong>”页面，删除所有“<strong>连接名称</strong>”列出的连接（<em>其中，TR069是网通远程控制猫并修改超级用户密码的连接；INTERNET被设置成了桥接，所以不能实现路由功能；另外两个应该是用来屏蔽第三、四个LAN口的。所以要全部删除。</em>），并创建新的连接：</li>
</ol>
<p><a href="http://picasaweb.google.com/lh/photo/G5p8or5AvVumvFOr89XLqQ?feat=embedwebsite" target="_blank" rel="noopener"><img src="http://lh5.ggpht.com/_ceUJ_lBTHzc/TEHd0wXELFI/AAAAAAAABbs/gtxn0tKGyJM/s400/2010-07-17.19%3A48%3A30.%E6%88%AA%E5%8F%96%E9%80%89%E5%8C%BA.01.png"></a></p>
<ol start="7">
<li><p>进入“<strong>网络</strong>”→“<strong>远程管理</strong>”页面，取消“<strong>周期上报功能</strong>”。</p>
</li>
<li><p>由于“<strong>用户管理</strong>”页面不提供超级用户改密码的功能，所以此时应下载最新的board.conf，修改里面的超级用户的密码，再上传到/etc目录，假设已登入FTP并切换到/etc目录下：</p>
</li>
</ol>
<blockquote><br>ftp&gt; put board.conf<br>200 PORT command successful. Consider using PASV.<br>150 Ok to send data.<br>226 File receive OK.<br>39516 bytes sent in 0.0195 seconds (2026565 bytes/s)<br>ftp&gt;<br></blockquote>

<ol start="9">
<li>最后重启猫即可。</li>
</ol>
<p>据说有使用TTL转USB线登入H108B的嵌入式Linux操作系统来破解超级用户的，但是我的猫的集成电路板上居然没有焊TTL引脚，显然H108B不只一个硬件版本，TTL线白买了。</p>
<p><a href="http://picasaweb.google.com/lh/photo/ceYq8gDnT3qY6IgBQuyjFg?feat=embedwebsite" target="_blank" rel="noopener"><img src="http://lh6.ggpht.com/_ceUJ_lBTHzc/TEHb1yqtElI/AAAAAAAABbY/KKlqPgcBMWo/s400/C360_2010-07-17%2011-07-10.jpg"></a></p>
<p><a href="http://picasaweb.google.com/lh/photo/omFbqTXkvVV4L86vGqyyng?feat=embedwebsite" target="_blank" rel="noopener"><img src="http://lh3.ggpht.com/_ceUJ_lBTHzc/TEHb19lGCzI/AAAAAAAABbc/7zaShWAUvUM/s400/C360_2010-07-17%2011-06-21.jpg"></a></p>
<p><a href="http://picasaweb.google.com/lh/photo/JfG_3EgD8BDChZVBM6xx9Q?feat=embedwebsite" target="_blank" rel="noopener"><img src="http://lh6.ggpht.com/_ceUJ_lBTHzc/TEHb2HXkwhI/AAAAAAAABbg/HazHHwsfXHk/s400/C360_2010-07-17%2011-06-09.jpg"></a></p>
<p><em>以上照片出自G7+Camera360</em></p>

      
    </div>
	
    <!--
	
    -->
    <!--
    
      <footer class="article-footer">
      </footer>
    
    -->
  </div>
  
</article>



    
      <article id="post-usage-of-ttl-wire-on-linux" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <myh11 itemprop="name">
      <a class="article-title-index" href="/post/usage-of-ttl-wire-on-linux/"><strong>TTL线在Linux下的用法</strong></a>
      <small class="article-date-index">&nbsp; 2010-07-18</small>
      <!--<a>
      <div = post.date  </div>
      </a>-->
      <br>
      <br> <!-- blair add -->
    </myh11>
  


      </header>
    
    <div class="article-meta">
      <!--<a href="/post/usage-of-ttl-wire-on-linux/" class="article-date">
  <time datetime="2010-07-17T16:00:00.000Z" itemprop="datePublished">2010-07-18</time>
</a>-->
      <!--
-->
      <!--
      
        <div class="article-comment-link-wrap">
          <a href="http://0x3f.org/post/usage-of-ttl-wire-on-linux/#disqus_thread" class="article-comment-link">Comments</a>
        </div>
      
      -->
    </div>
	
    <div class="article-entry" itemprop="articleBody">
      
        <p>虽然由于<a href="http://0x3f.org/?p=1544">我的H108B</a>没有TTL引脚而无法通过TTL线登入猫的<a href="http://en.wikipedia.org/wiki/BusyBox" target="_blank" rel="noopener">BusyBox</a>系统，但TTL线在Linux下的使用方法仍然值得一叙，因为除此之外，它还有较为广泛的用途，例如为路由器刷<a href="http://en.wikipedia.org/wiki/OpenWrt" target="_blank" rel="noopener">OpenWRT</a>系统等等。</p>
<p>TTL转USB端子是目前较为常见的此类设备，这得益于它的简单易用和便携性。在这类设备上最常见的就是台湾的Prolific Technology生产的<strong>PL2303</strong>：</p>
<p><a href="http://picasaweb.google.com/lh/photo/fAc0kt6VmnFFTUY7IA-VrA?feat=embedwebsite" target="_blank" rel="noopener"><img src="http://lh3.ggpht.com/_ceUJ_lBTHzc/TEHb1u6n7TI/AAAAAAAABbU/FA7aEZPTn-A/s400/C360_2010-07-17%2011-07-17.jpg"></a></p>
<p>这种芯片的驱动已被编译进Linux内核，如果使用的是较新版本的内核，则使用该芯片的TTL转USB端子会被自动识别，通常为<strong>/dev/ttyUSB0</strong>设备，使用<strong>lsusb</strong>命令可以查看：</p>
<blockquote><br>[lenin@archer ~]$ lsusb<br>Bus 008 Device 001: ID 1d6b:0001 Linux Foundation 1.1 root hub<br>Bus 007 Device 001: ID 1d6b:0001 Linux Foundation 1.1 root hub<br>Bus 006 Device 003: ID 067b:2303 Prolific Technology, Inc. PL2303 Serial Port<br>Bus 006 Device 001: ID 1d6b:0001 Linux Foundation 1.1 root hub<br></blockquote>

<p>将四根杜邦线连接到TTL转USB插头上，并接入相应设备的对应引脚。同一根线两端连接的引脚必须对应，另外，VCC引脚不能接线，否则会烧坏TTL转 USB芯片。</p>
<p>在计算机上使用串口通讯程序进行操控，常见的串口通讯程序有：<a href="http://en.wikipedia.org/wiki/Minicom" target="_blank" rel="noopener">minicom</a>，<a href="http://en.wikipedia.org/wiki/Microcom" target="_blank" rel="noopener">microcom</a>，picocom，tinyserial，xgcom。</p>
<p>以minicom为例，进入minicom的设置界面：</p>
<blockquote>sudo minicom -s</blockquote>

<p>先设置默认的通讯设备为ttyUSB0并设置硬件流控制（Hardware Flow Control）为No：</p>
<p><a href="http://picasaweb.google.com/lh/photo/YnqotA0Fo6Z883T7aKvDcg?feat=embedwebsite" target="_blank" rel="noopener"><img src="http://lh5.ggpht.com/_ceUJ_lBTHzc/TEMR710O6XI/AAAAAAAABb4/noM3E7ZEiuM/s800/2010-07-17.10%3A25%3A38.%E6%88%AA%E5%8F%96%E9%80%89%E5%8C%BA.01.png"></a></p>
<p><a href="http://picasaweb.google.com/lh/photo/G2S6THC9IqvBChZGkJfyqQ?feat=embedwebsite" target="_blank" rel="noopener"><img src="http://lh6.ggpht.com/_ceUJ_lBTHzc/TEMR7zBjcmI/AAAAAAAABb8/Z63_oSfjrnc/s400/2010-07-17.10%3A29%3A04.urxvt.01.png"></a></p>
<p>保存为缺省设置：</p>
<p><a href="http://picasaweb.google.com/lh/photo/lY9b49woVJhLdkPJqViT3Q?feat=embedwebsite" target="_blank" rel="noopener"><img src="http://lh4.ggpht.com/_ceUJ_lBTHzc/TEMR8Fjk3cI/AAAAAAAABcA/QnHscEzj1OY/s800/2010-07-17.10%3A29%3A35.%E6%88%AA%E5%8F%96%E9%80%89%E5%8C%BA.01.png"></a></p>
<p>启动minicom：</p>
<blockquote>sudo minicom</blockquote>

<p>理论上说，此时即可和设备进行通讯了。</p>
<p>Windows下要安装相应芯片的驱动，通讯程序一般用SecureCRT。</p>

      
    </div>
	
    <!--
	
    -->
    <!--
    
      <footer class="article-footer">
      </footer>
    
    -->
  </div>
  
</article>



    
      <article id="post-problem-on-pppoe-connections-on-linux" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <myh11 itemprop="name">
      <a class="article-title-index" href="/post/problem-on-pppoe-connections-on-linux/"><strong>Linux下pppoe连接建立后仍不能上网的问题</strong></a>
      <small class="article-date-index">&nbsp; 2010-07-10</small>
      <!--<a>
      <div = post.date  </div>
      </a>-->
      <br>
      <br> <!-- blair add -->
    </myh11>
  


      </header>
    
    <div class="article-meta">
      <!--<a href="/post/problem-on-pppoe-connections-on-linux/" class="article-date">
  <time datetime="2010-07-09T16:00:00.000Z" itemprop="datePublished">2010-07-10</time>
</a>-->
      <!--
-->
      <!--
      
        <div class="article-comment-link-wrap">
          <a href="http://0x3f.org/post/problem-on-pppoe-connections-on-linux/#disqus_thread" class="article-comment-link">Comments</a>
        </div>
      
      -->
    </div>
	
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>问题描述</strong></p>
<p>pppoe可以连接，ifconfig可以看到ppp0接口，一切正常，只是不能上网。</p>
<p><strong>解决办法</strong></p>
<p>使用如下命令查看路由表：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">route</span><br></pre></td></tr></table></figure>
<p>正常情况下返回的结果中应该有如下内容：</p>
<blockquote><br>default  *  0.0.0.0   U   0   0  0 ppp0<br></blockquote>

<p>如果没有，可手工添加：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">route add default dev ppp0</span><br></pre></td></tr></table></figure>
<p>如果可以上网，就成功了。</p>
<p>使用如下脚本在pppoe连接成功时自动添加路由表项：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> ifconfig ppp0  &gt; /dev/null 2&gt;&amp;1 ; <span class="keyword">then</span></span><br><span class="line">    route del default</span><br><span class="line">    route add default dev ppp0</span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>
<p>将上述内容保存成名为<strong>01-route.sh</strong>的文件，权限<strong>755</strong>，放到<strong>/etc/ppp/ip-up.d</strong>目录下。</p>
<p>然后创建以下两个脚本：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> ifconfig ppp0  &gt; /dev/null 2&gt;&amp;1 ; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">'PPPOE has already been switched on !'</span></span><br><span class="line">    <span class="built_in">exit</span> 0</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"> </span><br><span class="line">off</span><br><span class="line"> </span><br><span class="line">sudo pon</span><br><span class="line">sleep 5</span><br><span class="line">sudo /etc/ppp/ip-up</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> ! ifconfig ppp0  &gt; /dev/null 2&gt;&amp;1 ; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">'PPPOE has already been switched off !'</span></span><br><span class="line">    <span class="built_in">exit</span> 0</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"> </span><br><span class="line">sudo poff</span><br><span class="line">sudo /etc/ppp/ip-down</span><br></pre></td></tr></table></figure>
<p>分别命名为<strong>on</strong>和<strong>off</strong>并复制到环境变量PATH下，以后即可使用这两个脚本建立和注销pppoe连接。</p>
<p><strong>原因分析</strong></p>
<p>问题的原因是pppoe连接建立时，没有自动往路由表中添加相关路由项。</p>
<p>一般情况下，如果使用的是<strong>ppp</strong>做pppoe连接，其配置文件中默认会开启<strong>defaultroute</strong>选项，该选项的作用就是在pppoe连接建立时自动添加路由表项，但在路由表中已经存在<strong>default</strong>项时，该操作将不会进行。</p>
<p>一般有两种情况会使路由表中在pppoe连接建立前就存在default项。一种情况是网络接口配置中设置了route，如在archlinux下，就是rc.conf文件中的gateway项。如果使用的是静态地址，则需要做这种配置，但对于大多数使用DHCP动态分配IP地址的情况，这项配置则不需要。另一种情况就是ADSL Modem自带路由功能，在分配IP给计算机时也会自动添加一条路由表项。</p>

      
    </div>
	
    <!--
	
    -->
    <!--
    
      <footer class="article-footer">
      </footer>
    
    -->
  </div>
  
</article>



    
      <nav id="page-nav">
        <a class="extend prev" rel="prev" href="/page/35/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/34/">34</a><a class="page-number" href="/page/35/">35</a><span class="page-number current">36</span><a class="page-number" href="/page/37/">37</a><a class="page-number" href="/page/38/">38</a><span class="space">&hellip;</span><a class="page-number" href="/page/41/">41</a><a class="extend next" rel="next" href="/page/37/">Next &raquo;</a>
      </nav>
    

</section>
    <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2020 晴耕雨讀&nbsp;
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>, theme by <a href="http://github.com/52binge/hexo-theme-blairos">blairos</a>
    </div>
  </div>
</footer>

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX"],
    tex2jax: {
      inlineMath: [ ['$','$'], ['\\(','\\)'] ],
      displayMath: [ ['$$','$$']],
      processEscapes: true
    }
  });
</script>
<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML,http://myserver.com/MathJax/config/local/local.js">
</script>

    
<script type="text/javascript"> <!-- add by blair 0724 type=text/javascript -->
  var disqus_shortname = '0x3f';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="/js/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>
